# å®‰å…¨é…ç½®ä¼˜åŒ–åˆ†ææŠ¥å‘Š

## ğŸ” å‘ç°çš„ä¸»è¦é—®é¢˜

### 1. é‡å¤çš„JWTå®ç°å’Œé…ç½®

#### é—®é¢˜æè¿°
- [`JwtUtil.java`](campus-management-backend/src/main/java/com/campus/shared/util/JwtUtil.java:1) å’Œ [`JwtProvider.java`](campus-management-backend/src/main/java/com/campus/shared/security/JwtProvider.java:1) åŠŸèƒ½é‡å¤
- [`CustomConfigurationProperties.java`](campus-management-backend/src/main/java/com/campus/shared/config/CustomConfigurationProperties.java:14) ä¸­JWTé…ç½®ç»“æ„å†—ä½™

#### å®‰å…¨é£é™©
- ä»£ç ç»´æŠ¤å›°éš¾ï¼Œå®¹æ˜“å¯¼è‡´é…ç½®ä¸ä¸€è‡´
- å¤šå¥—JWTå®ç°å¢åŠ äº†å®‰å…¨æ¼æ´é£é™©

### 2. ç¡¬ç¼–ç æ•æ„Ÿä¿¡æ¯

#### é—®é¢˜æè¿°
- [`QuartzConfig.java`](campus-management-backend/src/main/java/com/campus/shared/config/QuartzConfig.java:114) ç¬¬114è¡Œç¡¬ç¼–ç æ•°æ®åº“å¯†ç 
- JWTå¯†é’¥ä½¿ç”¨ç®€å•å­—ç¬¦ä¸²

#### å®‰å…¨é£é™©
- æ•æ„Ÿä¿¡æ¯æ³„éœ²é£é™©
- ç”Ÿäº§ç¯å¢ƒå®‰å…¨éšæ‚£

### 3. JWTå®‰å…¨é…ç½®é—®é¢˜

#### é—®é¢˜æè¿°
- ä½¿ç”¨è¾ƒå¼±çš„HS256ç®—æ³•
- é»˜è®¤å¯†é’¥å¼ºåº¦ä¸è¶³
- Tokenè¿‡æœŸæ—¶é—´é…ç½®ä¸åˆç†

#### å®‰å…¨é£é™©
- Tokenå®¹æ˜“è¢«ç ´è§£
- ä¼šè¯åŠ«æŒé£é™©

### 4. CORSé…ç½®è¿‡äºå®½æ¾

#### é—®é¢˜æè¿°
- [`SecurityConfig.java`](campus-management-backend/src/main/java/com/campus/shared/config/SecurityConfig.java:174) å…è®¸æ‰€æœ‰åŸŸåè®¿é—®
- ç¼ºå°‘ä¸¥æ ¼çš„è·¨åŸŸæ§åˆ¶

#### å®‰å…¨é£é™©
- CSRFæ”»å‡»é£é™©
- è·¨åŸŸæ•°æ®æ³„éœ²

### 5. é‡å¤çš„æ‹¦æˆªå™¨é€»è¾‘

#### é—®é¢˜æè¿°
- [`AdminAuthInterceptor.java`](campus-management-backend/src/main/java/com/campus/shared/security/AdminAuthInterceptor.java:1) å’Œ [`AdminJwtInterceptor.java`](campus-management-backend/src/main/java/com/campus/shared/security/AdminJwtInterceptor.java:1) åŠŸèƒ½é‡å 
- æƒé™æ£€æŸ¥é€»è¾‘åˆ†æ•£

#### å®‰å…¨é£é™©
- æƒé™éªŒè¯ä¸ä¸€è‡´
- å®‰å…¨ç­–ç•¥æ‰§è¡Œæ··ä¹±

### 6. å¼‚å¸¸å¤„ç†é‡å¤å®šä¹‰

#### é—®é¢˜æè¿°
- [`GlobalExceptionHandler.java`](campus-management-backend/src/main/java/com/campus/shared/exception/GlobalExceptionHandler.java:224) ä¸­é‡å¤å®šä¹‰BusinessExceptionç±»
- ä¸ç‹¬ç«‹çš„å¼‚å¸¸ç±»å†²çª

#### å®‰å…¨é£é™©
- å¼‚å¸¸å¤„ç†ä¸ä¸€è‡´
- å¯èƒ½æ³„éœ²æ•æ„Ÿä¿¡æ¯

## ğŸ› ï¸ ä¼˜åŒ–å»ºè®®

### 1. ç»Ÿä¸€JWTå®ç°

**ä¼˜å…ˆçº§ï¼šé«˜**

- ä¿ç•™ `JwtUtil.java`ï¼Œç§»é™¤ `JwtProvider.java`
- ç»Ÿä¸€JWTé…ç½®åˆ°ä¸€ä¸ªé…ç½®ç±»
- ä½¿ç”¨æ›´å®‰å…¨çš„RS256ç®—æ³•

### 2. å¤–éƒ¨åŒ–æ•æ„Ÿé…ç½®

**ä¼˜å…ˆçº§ï¼šé«˜**

- å°†æ•°æ®åº“å¯†ç ç§»åˆ°ç¯å¢ƒå˜é‡
- ä½¿ç”¨Spring Bootçš„åŠ å¯†é…ç½®
- å®ç°å¯†é’¥è½®æ¢æœºåˆ¶

### 3. å¼ºåŒ–JWTå®‰å…¨

**ä¼˜å…ˆçº§ï¼šé«˜**

- å‡çº§åˆ°RS256éå¯¹ç§°åŠ å¯†
- å¢åŠ JWTé»‘åå•æœºåˆ¶
- å®ç°Tokenåˆ·æ–°ç­–ç•¥
- æ·»åŠ é˜²é‡æ”¾æ”»å‡»ä¿æŠ¤

### 4. æ”¶ç´§CORSé…ç½®

**ä¼˜å…ˆçº§ï¼šä¸­**

- é™åˆ¶å…è®¸çš„åŸŸååˆ—è¡¨
- è®¾ç½®ä¸¥æ ¼çš„è¯·æ±‚å¤´ç™½åå•
- é…ç½®é¢„æ£€è¯·æ±‚ç¼“å­˜æ—¶é—´

### 5. åˆå¹¶æ‹¦æˆªå™¨é€»è¾‘

**ä¼˜å…ˆçº§ï¼šä¸­**

- ç»Ÿä¸€ç®¡ç†åå°è®¤è¯é€»è¾‘
- å®ç°åˆ†å±‚æƒé™éªŒè¯
- æ·»åŠ æ¥å£è®¿é—®é¢‘ç‡é™åˆ¶

### 6. å®Œå–„å¼‚å¸¸å¤„ç†

**ä¼˜å…ˆçº§ï¼šä½**

- ç§»é™¤é‡å¤çš„å¼‚å¸¸ç±»å®šä¹‰
- ç»Ÿä¸€å¼‚å¸¸å“åº”æ ¼å¼
- é¿å…æ•æ„Ÿä¿¡æ¯æ³„éœ²

## ğŸ“Š é£é™©è¯„ä¼°

| é—®é¢˜ç±»åˆ« | é£é™©ç­‰çº§ | å½±å“èŒƒå›´ | ä¿®å¤éš¾åº¦ |
|---------|---------|---------|---------|
| JWTé‡å¤å®ç° | ä¸­ | å…¨ç³»ç»Ÿ | ä¸­ |
| ç¡¬ç¼–ç æ•æ„Ÿä¿¡æ¯ | é«˜ | æ•°æ®åº“å®‰å…¨ | ä½ |
| JWTå®‰å…¨é…ç½® | é«˜ | ç”¨æˆ·è®¤è¯ | ä¸­ |
| CORSé…ç½® | ä¸­ | è·¨åŸŸå®‰å…¨ | ä½ |
| æ‹¦æˆªå™¨é‡å¤ | ä½ | åå°ç®¡ç† | ä¸­ |
| å¼‚å¸¸å¤„ç†é‡å¤ | ä½ | é”™è¯¯å¤„ç† | ä½ |

## ğŸš€ å®æ–½è®¡åˆ’

### ç¬¬ä¸€é˜¶æ®µï¼ˆç´§æ€¥ä¿®å¤ï¼‰
1. å¤–éƒ¨åŒ–ç¡¬ç¼–ç å¯†ç 
2. å¼ºåŒ–JWTå¯†é’¥é…ç½®
3. æ”¶ç´§CORSè®¾ç½®

### ç¬¬äºŒé˜¶æ®µï¼ˆæ¶æ„ä¼˜åŒ–ï¼‰
1. ç»Ÿä¸€JWTå®ç°
2. åˆå¹¶æ‹¦æˆªå™¨é€»è¾‘
3. å®Œå–„å®‰å…¨ç­–ç•¥

### ç¬¬ä¸‰é˜¶æ®µï¼ˆå¢å¼ºåŠŸèƒ½ï¼‰
1. å®ç°JWTé»‘åå•
2. æ·»åŠ é˜²é‡æ”¾æ”»å‡»
3. å¢åŠ å®‰å…¨ç›‘æ§

## ğŸ“‹ æ£€æŸ¥æ¸…å•

- [ ] ç§»é™¤ç¡¬ç¼–ç å¯†ç 
- [ ] å¼ºåŒ–JWTé…ç½®
- [ ] æ”¶ç´§CORSè®¾ç½®
- [ ] ç»Ÿä¸€JWTå®ç°
- [ ] åˆå¹¶æ‹¦æˆªå™¨
- [ ] ä¿®å¤å¼‚å¸¸é‡å¤å®šä¹‰
- [ ] æ·»åŠ å®‰å…¨æµ‹è¯•
- [ ] æ›´æ–°æ–‡æ¡£

## ğŸ”— ç›¸å…³æ–‡ä»¶

- é…ç½®ç±»ï¼š`SecurityConfig.java`, `JwtUtil.java`, `QuartzConfig.java`
- æ‹¦æˆªå™¨ï¼š`AdminAuthInterceptor.java`, `AdminJwtInterceptor.java`
- å¼‚å¸¸å¤„ç†ï¼š`GlobalExceptionHandler.java`, `BusinessException.java`
- å®‰å…¨ç»„ä»¶ï¼š`JwtProvider.java`, `CustomUserDetailsService.java`

---

*ç”Ÿæˆæ—¶é—´ï¼š2025å¹´6æœˆ12æ—¥*  
*åˆ†æèŒƒå›´ï¼šæ™ºæ…§æ ¡å›­ç®¡ç†ç³»ç»Ÿå®‰å…¨é…ç½®*