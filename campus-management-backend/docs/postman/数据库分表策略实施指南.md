# æ•°æ®åº“åˆ†è¡¨ç­–ç•¥å®æ–½æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜æ™ºæ…§æ ¡å›­ç®¡ç†ç³»ç»Ÿçš„æ•°æ®åº“åˆ†è¡¨ç­–ç•¥ï¼Œé‡ç‚¹è§£å†³å­¦ç”Ÿã€æˆç»©ç­‰å¤§æ•°æ®é‡è¡¨çš„æ€§èƒ½é—®é¢˜ã€‚

## ğŸ¯ åˆ†è¡¨ç›®æ ‡

- ğŸš€ æå‡æŸ¥è¯¢æ€§èƒ½ï¼Œå•è¡¨æŸ¥è¯¢æ—¶é—´ < 100ms
- ğŸ“ˆ æ”¯æŒæ•°æ®é‡çº¿æ€§å¢é•¿ï¼Œå•è¡¨æ§åˆ¶åœ¨500ä¸‡æ¡è®°å½•ä»¥å†…
- ğŸ”„ å®ç°æ•°æ®å½’æ¡£æœºåˆ¶ï¼Œå†å²æ•°æ®è‡ªåŠ¨è¿ç§»
- âš¡ ä¼˜åŒ–å†™å…¥æ€§èƒ½ï¼Œæ”¯æŒé«˜å¹¶å‘æ“ä½œ
- ğŸ›¡ï¸ ä¿è¯æ•°æ®ä¸€è‡´æ€§å’Œå®Œæ•´æ€§

## ğŸ“Š åˆ†è¡¨ç­–ç•¥è§„åˆ’

### 1. åˆ†è¡¨å¯¹è±¡è¯†åˆ«

| è¡¨å | å½“å‰æ•°æ®é‡ | å¹´å¢é•¿é‡ | åˆ†è¡¨ç­–ç•¥ | åˆ†è¡¨é”® |
|------|------------|----------|----------|--------|
| tb_student | 50,000 | 15,000 | æŒ‰å…¥å­¦å¹´ä»½ | enrollment_year |
| tb_grade | 500,000 | 200,000 | æŒ‰å­¦æœŸ | semester |
| tb_course_selection | 300,000 | 120,000 | æŒ‰å­¦æœŸ | semester |
| tb_attendance | 1,000,000 | 500,000 | æŒ‰å¹´æœˆ | attendance_date |
| tb_assignment_submission | 200,000 | 100,000 | æŒ‰å­¦æœŸ | semester |
| tb_exam_record | 100,000 | 50,000 | æŒ‰å­¦æœŸ | semester |
| tb_file_access_log | 2,000,000 | 1,000,000 | æŒ‰æœˆ | access_time |
| tb_activity_log | 5,000,000 | 2,000,000 | æŒ‰æœˆ | created_at |

### 2. åˆ†è¡¨å‘½åè§„èŒƒ

```
åŸè¡¨å_åˆ†ç‰‡æ ‡è¯†
ä¾‹å¦‚ï¼š
- tb_student_2024 (2024å¹´å…¥å­¦å­¦ç”Ÿ)
- tb_grade_2024_1 (2024å¹´ç¬¬1å­¦æœŸæˆç»©)
- tb_attendance_202406 (2024å¹´6æœˆè€ƒå‹¤)
- tb_activity_log_202406 (2024å¹´6æœˆæ´»åŠ¨æ—¥å¿—)
```

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### 1. åˆ†ç‰‡ä¸­é—´ä»¶é€‰æ‹©

**æ¨èä½¿ç”¨ Apache ShardingSphere**

```xml
<!-- pom.xml æ·»åŠ ä¾èµ– -->
<dependency>
    <groupId>org.apache.shardingsphere</groupId>
    <artifactId>shardingsphere-jdbc-core-spring-boot-starter</artifactId>
    <version>5.4.1</version>
</dependency>
```

### 2. é…ç½®ç»“æ„

```yaml
# application-sharding.yml
spring:
  shardingsphere:
    datasource:
      names: ds0
      ds0:
        type: com.zaxxer.hikari.HikariDataSource
        driver-class-name: com.mysql.cj.jdbc.Driver
        jdbc-url: jdbc:mysql://localhost:3306/campus_management_db
        username: root
        password: xiaoxiao123
    
    rules:
      sharding:
        tables:
          # å­¦ç”Ÿè¡¨åˆ†ç‰‡é…ç½®
          tb_student:
            actual-data-nodes: ds0.tb_student_$->{2024..2030}
            table-strategy:
              standard:
                sharding-column: enrollment_year
                sharding-algorithm-name: student-table-inline
          
          # æˆç»©è¡¨åˆ†ç‰‡é…ç½®
          tb_grade:
            actual-data-nodes: ds0.tb_grade_$->{2024..2030}_$->{1..2}
            table-strategy:
              standard:
                sharding-column: semester
                sharding-algorithm-name: grade-table-inline
        
        sharding-algorithms:
          student-table-inline:
            type: INLINE
            props:
              algorithm-expression: tb_student_$->{enrollment_year}
          
          grade-table-inline:
            type: INLINE
            props:
              algorithm-expression: tb_grade_$->{semester.replace('-', '_')}
    
    props:
      sql-show: true
```

## ğŸ“‹ å®æ–½æ­¥éª¤

### ç¬¬ä¸€é˜¶æ®µï¼šå­¦ç”Ÿè¡¨åˆ†è¡¨

#### 1.1 åˆ›å»ºåˆ†è¡¨ç»“æ„

```sql
-- åˆ›å»ºå­¦ç”Ÿåˆ†è¡¨è„šæœ¬
-- ä½ç½®ï¼šsrc/main/resources/db/sharding/01_create_student_sharding_tables.sql

-- 2024å¹´å…¥å­¦å­¦ç”Ÿè¡¨
CREATE TABLE tb_student_2024 (
    LIKE tb_student INCLUDING ALL
);

-- 2025å¹´å…¥å­¦å­¦ç”Ÿè¡¨  
CREATE TABLE tb_student_2025 (
    LIKE tb_student INCLUDING ALL
);

-- 2026å¹´å…¥å­¦å­¦ç”Ÿè¡¨
CREATE TABLE tb_student_2026 (
    LIKE tb_student INCLUDING ALL
);

-- 2027å¹´å…¥å­¦å­¦ç”Ÿè¡¨
CREATE TABLE tb_student_2027 (
    LIKE tb_student INCLUDING ALL
);

-- æ·»åŠ åˆ†è¡¨ç‰¹å®šç´¢å¼•
ALTER TABLE tb_student_2024 ADD INDEX idx_enrollment_year (enrollment_year);
ALTER TABLE tb_student_2025 ADD INDEX idx_enrollment_year (enrollment_year);
ALTER TABLE tb_student_2026 ADD INDEX idx_enrollment_year (enrollment_year);
ALTER TABLE tb_student_2027 ADD INDEX idx_enrollment_year (enrollment_year);
```

#### 1.2 æ•°æ®è¿ç§»è„šæœ¬

```sql
-- å­¦ç”Ÿæ•°æ®è¿ç§»è„šæœ¬
-- ä½ç½®ï¼šsrc/main/resources/db/sharding/02_migrate_student_data.sql

-- è¿ç§»2024å¹´å…¥å­¦å­¦ç”Ÿ
INSERT INTO tb_student_2024 
SELECT * FROM tb_student WHERE enrollment_year = 2024;

-- è¿ç§»2025å¹´å…¥å­¦å­¦ç”Ÿ
INSERT INTO tb_student_2025 
SELECT * FROM tb_student WHERE enrollment_year = 2025;

-- éªŒè¯æ•°æ®è¿ç§»
SELECT 
    'tb_student_2024' as table_name, COUNT(*) as count 
FROM tb_student_2024
UNION ALL
SELECT 
    'tb_student_2025' as table_name, COUNT(*) as count 
FROM tb_student_2025
UNION ALL
SELECT 
    'tb_student_original' as table_name, COUNT(*) as count 
FROM tb_student;
```

#### 1.3 åˆ†ç‰‡ç®—æ³•å®ç°

```java
// ä½ç½®ï¼šsrc/main/java/com/campus/infrastructure/sharding/StudentTableShardingAlgorithm.java
package com.campus.infrastructure.sharding;

import org.apache.shardingsphere.sharding.api.sharding.standard.PreciseShardingAlgorithm;
import org.apache.shardingsphere.sharding.api.sharding.standard.PreciseShardingValue;

import java.util.Collection;

public class StudentTableShardingAlgorithm implements PreciseShardingAlgorithm<Integer> {
    
    @Override
    public String doSharding(Collection<String> availableTargetNames, 
                           PreciseShardingValue<Integer> shardingValue) {
        Integer enrollmentYear = shardingValue.getValue();
        String targetTable = "tb_student_" + enrollmentYear;
        
        // éªŒè¯ç›®æ ‡è¡¨æ˜¯å¦å­˜åœ¨
        if (availableTargetNames.contains(targetTable)) {
            return targetTable;
        }
        
        // å¦‚æœç›®æ ‡è¡¨ä¸å­˜åœ¨ï¼Œè¿”å›é»˜è®¤è¡¨æˆ–æŠ›å‡ºå¼‚å¸¸
        throw new IllegalArgumentException("æ‰¾ä¸åˆ°å¯¹åº”çš„åˆ†è¡¨: " + targetTable);
    }
}
```

### ç¬¬äºŒé˜¶æ®µï¼šæˆç»©è¡¨åˆ†è¡¨

#### 2.1 åˆ›å»ºæˆç»©åˆ†è¡¨

```sql
-- åˆ›å»ºæˆç»©åˆ†è¡¨è„šæœ¬
-- ä½ç½®ï¼šsrc/main/resources/db/sharding/03_create_grade_sharding_tables.sql

-- 2024å¹´ç¬¬1å­¦æœŸæˆç»©è¡¨
CREATE TABLE tb_grade_2024_1 (
    LIKE tb_grade INCLUDING ALL
);

-- 2024å¹´ç¬¬2å­¦æœŸæˆç»©è¡¨
CREATE TABLE tb_grade_2024_2 (
    LIKE tb_grade INCLUDING ALL
);

-- 2025å¹´ç¬¬1å­¦æœŸæˆç»©è¡¨
CREATE TABLE tb_grade_2025_1 (
    LIKE tb_grade INCLUDING ALL
);

-- 2025å¹´ç¬¬2å­¦æœŸæˆç»©è¡¨
CREATE TABLE tb_grade_2025_2 (
    LIKE tb_grade INCLUDING ALL
);

-- æ·»åŠ åˆ†è¡¨ç´¢å¼•
ALTER TABLE tb_grade_2024_1 ADD INDEX idx_semester (semester);
ALTER TABLE tb_grade_2024_1 ADD INDEX idx_student_course (student_id, course_id);
ALTER TABLE tb_grade_2024_2 ADD INDEX idx_semester (semester);
ALTER TABLE tb_grade_2024_2 ADD INDEX idx_student_course (student_id, course_id);
ALTER TABLE tb_grade_2025_1 ADD INDEX idx_semester (semester);
ALTER TABLE tb_grade_2025_1 ADD INDEX idx_student_course (student_id, course_id);
ALTER TABLE tb_grade_2025_2 ADD INDEX idx_semester (semester);
ALTER TABLE tb_grade_2025_2 ADD INDEX idx_student_course (student_id, course_id);
```

#### 2.2 æˆç»©åˆ†ç‰‡ç®—æ³•

```java
// ä½ç½®ï¼šsrc/main/java/com/campus/infrastructure/sharding/GradeTableShardingAlgorithm.java
package com.campus.infrastructure.sharding;

import org.apache.shardingsphere.sharding.api.sharding.standard.PreciseShardingAlgorithm;
import org.apache.shardingsphere.sharding.api.sharding.standard.PreciseShardingValue;

import java.util.Collection;

public class GradeTableShardingAlgorithm implements PreciseShardingAlgorithm<String> {
    
    @Override
    public String doSharding(Collection<String> availableTargetNames, 
                           PreciseShardingValue<String> shardingValue) {
        String semester = shardingValue.getValue();
        // å°† "2024-1" è½¬æ¢ä¸º "tb_grade_2024_1"
        String targetTable = "tb_grade_" + semester.replace("-", "_");
        
        if (availableTargetNames.contains(targetTable)) {
            return targetTable;
        }
        
        throw new IllegalArgumentException("æ‰¾ä¸åˆ°å¯¹åº”çš„æˆç»©åˆ†è¡¨: " + targetTable);
    }
}
```

### ç¬¬ä¸‰é˜¶æ®µï¼šè€ƒå‹¤è¡¨åˆ†è¡¨ï¼ˆæŒ‰æœˆï¼‰

#### 3.1 è€ƒå‹¤è¡¨åˆ†è¡¨ç­–ç•¥

```sql
-- åˆ›å»ºè€ƒå‹¤åˆ†è¡¨è„šæœ¬
-- ä½ç½®ï¼šsrc/main/resources/db/sharding/04_create_attendance_sharding_tables.sql

-- æŒ‰å¹´æœˆåˆ›å»ºè€ƒå‹¤è¡¨
CREATE TABLE tb_attendance_202406 (
    LIKE tb_attendance INCLUDING ALL
);

CREATE TABLE tb_attendance_202407 (
    LIKE tb_attendance INCLUDING ALL
);

-- æ·»åŠ åˆ†è¡¨ç´¢å¼•
ALTER TABLE tb_attendance_202406 ADD INDEX idx_attendance_date (attendance_date);
ALTER TABLE tb_attendance_202406 ADD INDEX idx_student_date (student_id, attendance_date);
ALTER TABLE tb_attendance_202407 ADD INDEX idx_attendance_date (attendance_date);
ALTER TABLE tb_attendance_202407 ADD INDEX idx_student_date (student_id, attendance_date);
```

#### 3.2 è€ƒå‹¤åˆ†ç‰‡ç®—æ³•

```java
// ä½ç½®ï¼šsrc/main/java/com/campus/infrastructure/sharding/AttendanceTableShardingAlgorithm.java
package com.campus.infrastructure.sharding;

import org.apache.shardingsphere.sharding.api.sharding.standard.PreciseShardingAlgorithm;
import org.apache.shardingsphere.sharding.api.sharding.standard.PreciseShardingValue;

import java.time.LocalDate;
import java.time.format.DateTimeFormatter;
import java.util.Collection;

public class AttendanceTableShardingAlgorithm implements PreciseShardingAlgorithm<LocalDate> {
    
    private static final DateTimeFormatter FORMATTER = DateTimeFormatter.ofPattern("yyyyMM");
    
    @Override
    public String doSharding(Collection<String> availableTargetNames, 
                           PreciseShardingValue<LocalDate> shardingValue) {
        LocalDate attendanceDate = shardingValue.getValue();
        String yearMonth = attendanceDate.format(FORMATTER);
        String targetTable = "tb_attendance_" + yearMonth;
        
        if (availableTargetNames.contains(targetTable)) {
            return targetTable;
        }
        
        throw new IllegalArgumentException("æ‰¾ä¸åˆ°å¯¹åº”çš„è€ƒå‹¤åˆ†è¡¨: " + targetTable);
    }
}
```

## ğŸ”§ åˆ†è¡¨ç®¡ç†å·¥å…·

### 1. è‡ªåŠ¨å»ºè¡¨æœåŠ¡

```java
// ä½ç½®ï¼šsrc/main/java/com/campus/infrastructure/sharding/ShardingTableManager.java
package com.campus.infrastructure.sharding;

import lombok.RequiredArgsConstructor;
import lombok.extern.slf4j.Slf4j;
import org.springframework.jdbc.core.JdbcTemplate;
import org.springframework.stereotype.Service;

import java.time.LocalDate;
import java.time.format.DateTimeFormatter;

@Slf4j
@Service
@RequiredArgsConstructor
public class ShardingTableManager {
    
    private final JdbcTemplate jdbcTemplate;
    
    /**
     * è‡ªåŠ¨åˆ›å»ºå­¦ç”Ÿåˆ†è¡¨
     */
    public void createStudentTable(int enrollmentYear) {
        String tableName = "tb_student_" + enrollmentYear;
        
        if (tableExists(tableName)) {
            log.info("å­¦ç”Ÿåˆ†è¡¨å·²å­˜åœ¨: {}", tableName);
            return;
        }
        
        String sql = String.format(
            "CREATE TABLE %s (LIKE tb_student INCLUDING ALL)", tableName);
        
        try {
            jdbcTemplate.execute(sql);
            
            // æ·»åŠ åˆ†è¡¨ç‰¹å®šç´¢å¼•
            String indexSql = String.format(
                "ALTER TABLE %s ADD INDEX idx_enrollment_year (enrollment_year)", tableName);
            jdbcTemplate.execute(indexSql);
            
            log.info("æˆåŠŸåˆ›å»ºå­¦ç”Ÿåˆ†è¡¨: {}", tableName);
        } catch (Exception e) {
            log.error("åˆ›å»ºå­¦ç”Ÿåˆ†è¡¨å¤±è´¥: {}", tableName, e);
            throw new RuntimeException("åˆ›å»ºå­¦ç”Ÿåˆ†è¡¨å¤±è´¥", e);
        }
    }
    
    /**
     * è‡ªåŠ¨åˆ›å»ºæˆç»©åˆ†è¡¨
     */
    public void createGradeTable(String semester) {
        String tableName = "tb_grade_" + semester.replace("-", "_");
        
        if (tableExists(tableName)) {
            log.info("æˆç»©åˆ†è¡¨å·²å­˜åœ¨: {}", tableName);
            return;
        }
        
        String sql = String.format(
            "CREATE TABLE %s (LIKE tb_grade INCLUDING ALL)", tableName);
        
        try {
            jdbcTemplate.execute(sql);
            
            // æ·»åŠ åˆ†è¡¨ç‰¹å®šç´¢å¼•
            String indexSql1 = String.format(
                "ALTER TABLE %s ADD INDEX idx_semester (semester)", tableName);
            String indexSql2 = String.format(
                "ALTER TABLE %s ADD INDEX idx_student_course (student_id, course_id)", tableName);
            
            jdbcTemplate.execute(indexSql1);
            jdbcTemplate.execute(indexSql2);
            
            log.info("æˆåŠŸåˆ›å»ºæˆç»©åˆ†è¡¨: {}", tableName);
        } catch (Exception e) {
            log.error("åˆ›å»ºæˆç»©åˆ†è¡¨å¤±è´¥: {}", tableName, e);
            throw new RuntimeException("åˆ›å»ºæˆç»©åˆ†è¡¨å¤±è´¥", e);
        }
    }
    
    /**
     * è‡ªåŠ¨åˆ›å»ºè€ƒå‹¤åˆ†è¡¨
     */
    public void createAttendanceTable(LocalDate date) {
        String yearMonth = date.format(DateTimeFormatter.ofPattern("yyyyMM"));
        String tableName = "tb_attendance_" + yearMonth;
        
        if (tableExists(tableName)) {
            log.info("è€ƒå‹¤åˆ†è¡¨å·²å­˜åœ¨: {}", tableName);
            return;
        }
        
        String sql = String.format(
            "CREATE TABLE %s (LIKE tb_attendance INCLUDING ALL)", tableName);
        
        try {
            jdbcTemplate.execute(sql);
            
            // æ·»åŠ åˆ†è¡¨ç‰¹å®šç´¢å¼•
            String indexSql1 = String.format(
                "ALTER TABLE %s ADD INDEX idx_attendance_date (attendance_date)", tableName);
            String indexSql2 = String.format(
                "ALTER TABLE %s ADD INDEX idx_student_date (student_id, attendance_date)", tableName);
            
            jdbcTemplate.execute(indexSql1);
            jdbcTemplate.execute(indexSql2);
            
            log.info("æˆåŠŸåˆ›å»ºè€ƒå‹¤åˆ†è¡¨: {}", tableName);
        } catch (Exception e) {
            log.error("åˆ›å»ºè€ƒå‹¤åˆ†è¡¨å¤±è´¥: {}", tableName, e);
            throw new RuntimeException("åˆ›å»ºè€ƒå‹¤åˆ†è¡¨å¤±è´¥", e);
        }
    }
    
    /**
     * æ£€æŸ¥è¡¨æ˜¯å¦å­˜åœ¨
     */
    private boolean tableExists(String tableName) {
        String sql = "SELECT COUNT(*) FROM information_schema.tables " +
                    "WHERE table_schema = DATABASE() AND table_name = ?";
        Integer count = jdbcTemplate.queryForObject(sql, Integer.class, tableName);
        return count != null && count > 0;
    }
}
```

### 2. å®šæ—¶å»ºè¡¨ä»»åŠ¡

```java
// ä½ç½®ï¼šsrc/main/java/com/campus/infrastructure/sharding/ShardingTableScheduler.java
package com.campus.infrastructure.sharding;

import lombok.RequiredArgsConstructor;
import lombok.extern.slf4j.Slf4j;
import org.springframework.scheduling.annotation.Scheduled;
import org.springframework.stereotype.Component;

import java.time.LocalDate;

@Slf4j
@Component
@RequiredArgsConstructor
public class ShardingTableScheduler {
    
    private final ShardingTableManager shardingTableManager;
    
    /**
     * æ¯æœˆ1å·è‡ªåŠ¨åˆ›å»ºä¸‹ä¸ªæœˆçš„è€ƒå‹¤è¡¨
     */
    @Scheduled(cron = "0 0 2 1 * ?")
    public void createNextMonthAttendanceTable() {
        LocalDate nextMonth = LocalDate.now().plusMonths(1);
        log.info("å¼€å§‹åˆ›å»ºä¸‹ä¸ªæœˆè€ƒå‹¤åˆ†è¡¨: {}", nextMonth);
        
        try {
            shardingTableManager.createAttendanceTable(nextMonth);
            log.info("æˆåŠŸåˆ›å»ºä¸‹ä¸ªæœˆè€ƒå‹¤åˆ†è¡¨");
        } catch (Exception e) {
            log.error("åˆ›å»ºä¸‹ä¸ªæœˆè€ƒå‹¤åˆ†è¡¨å¤±è´¥", e);
        }
    }
    
    /**
     * æ¯å¹´7æœˆ1å·è‡ªåŠ¨åˆ›å»ºä¸‹ä¸€å¹´çš„å­¦ç”Ÿè¡¨
     */
    @Scheduled(cron = "0 0 2 1 7 ?")
    public void createNextYearStudentTable() {
        int nextYear = LocalDate.now().getYear() + 1;
        log.info("å¼€å§‹åˆ›å»ºä¸‹ä¸€å¹´å­¦ç”Ÿåˆ†è¡¨: {}", nextYear);
        
        try {
            shardingTableManager.createStudentTable(nextYear);
            log.info("æˆåŠŸåˆ›å»ºä¸‹ä¸€å¹´å­¦ç”Ÿåˆ†è¡¨");
        } catch (Exception e) {
            log.error("åˆ›å»ºä¸‹ä¸€å¹´å­¦ç”Ÿåˆ†è¡¨å¤±è´¥", e);
        }
    }
}
```

## ğŸ“Š æ•°æ®å½’æ¡£ç­–ç•¥

### 1. å½’æ¡£é…ç½®

```yaml
# application.yml æ–°å¢å½’æ¡£é…ç½®
campus:
  data-archive:
    enabled: true
    # å½’æ¡£ç­–ç•¥
    strategies:
      attendance:
        archive-after-months: 12  # 12ä¸ªæœˆåå½’æ¡£
        delete-after-months: 36   # 36ä¸ªæœˆååˆ é™¤
      grade:
        archive-after-years: 3    # 3å¹´åå½’æ¡£
        delete-after-years: 7     # 7å¹´ååˆ é™¤
      activity-log:
        archive-after-months: 6   # 6ä¸ªæœˆåå½’æ¡£
        delete-after-months: 12   # 12ä¸ªæœˆååˆ é™¤
    
    # å½’æ¡£å­˜å‚¨
    archive-storage:
      type: file  # file, oss, database
      path: /data/campus/archive/
      compress: true
      encrypt: true
```

### 2. å½’æ¡£æœåŠ¡å®ç°

```java
// ä½ç½®ï¼šsrc/main/java/com/campus/infrastructure/archive/DataArchiveService.java
package com.campus.infrastructure.archive;

import lombok.RequiredArgsConstructor;
import lombok.extern.slf4j.Slf4j;
import org.springframework.scheduling.annotation.Scheduled;
import org.springframework.stereotype.Service;

import java.time.LocalDate;

@Slf4j
@Service
@RequiredArgsConstructor
public class DataArchiveService {
    
    /**
     * æ¯å¤©å‡Œæ™¨3ç‚¹æ‰§è¡Œæ•°æ®å½’æ¡£
     */
    @Scheduled(cron = "0 0 3 * * ?")
    public void executeDataArchive() {
        log.info("å¼€å§‹æ‰§è¡Œæ•°æ®å½’æ¡£ä»»åŠ¡");
        
        try {
            // å½’æ¡£è€ƒå‹¤æ•°æ®
            archiveAttendanceData();
            
            // å½’æ¡£æ´»åŠ¨æ—¥å¿—
            archiveActivityLogs();
            
            // å½’æ¡£æ–‡ä»¶è®¿é—®æ—¥å¿—
            archiveFileAccessLogs();
            
            log.info("æ•°æ®å½’æ¡£ä»»åŠ¡æ‰§è¡Œå®Œæˆ");
        } catch (Exception e) {
            log.error("æ•°æ®å½’æ¡£ä»»åŠ¡æ‰§è¡Œå¤±è´¥", e);
        }
    }
    
    private void archiveAttendanceData() {
        LocalDate archiveDate = LocalDate.now().minusMonths(12);
        // å®ç°è€ƒå‹¤æ•°æ®å½’æ¡£é€»è¾‘
        log.info("å½’æ¡£{}ä¹‹å‰çš„è€ƒå‹¤æ•°æ®", archiveDate);
    }
    
    private void archiveActivityLogs() {
        LocalDate archiveDate = LocalDate.now().minusMonths(6);
        // å®ç°æ´»åŠ¨æ—¥å¿—å½’æ¡£é€»è¾‘
        log.info("å½’æ¡£{}ä¹‹å‰çš„æ´»åŠ¨æ—¥å¿—", archiveDate);
    }
    
    private void archiveFileAccessLogs() {
        LocalDate archiveDate = LocalDate.now().minusMonths(3);
        // å®ç°æ–‡ä»¶è®¿é—®æ—¥å¿—å½’æ¡£é€»è¾‘
        log.info("å½’æ¡£{}ä¹‹å‰çš„æ–‡ä»¶è®¿é—®æ—¥å¿—", archiveDate);
    }
}
```

## ğŸ“‹ å®æ–½æ£€æŸ¥æ¸…å•

### âœ… å‡†å¤‡é˜¶æ®µ
- [ ] å¤‡ä»½ç°æœ‰æ•°æ®
- [ ] è¯„ä¼°æ•°æ®é‡å’Œå¢é•¿è¶‹åŠ¿
- [ ] åˆ¶å®šåˆ†è¡¨ç­–ç•¥
- [ ] å‡†å¤‡æµ‹è¯•ç¯å¢ƒ

### âœ… å®æ–½é˜¶æ®µ
- [ ] å®‰è£…ShardingSphereä¾èµ–
- [ ] é…ç½®åˆ†ç‰‡è§„åˆ™
- [ ] åˆ›å»ºåˆ†è¡¨ç»“æ„
- [ ] å®ç°åˆ†ç‰‡ç®—æ³•
- [ ] æ•°æ®è¿ç§»éªŒè¯
- [ ] åº”ç”¨ä»£ç é€‚é…

### âœ… éªŒè¯é˜¶æ®µ
- [ ] åŠŸèƒ½æµ‹è¯•
- [ ] æ€§èƒ½æµ‹è¯•
- [ ] æ•°æ®ä¸€è‡´æ€§éªŒè¯
- [ ] æ•…éšœæ¢å¤æµ‹è¯•

### âœ… ä¸Šçº¿é˜¶æ®µ
- [ ] ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²
- [ ] ç›‘æ§é…ç½®
- [ ] æ€§èƒ½ç›‘æ§
- [ ] æ•°æ®å½’æ¡£é…ç½®

## ğŸ“ˆ æ€§èƒ½é¢„æœŸ

| æŒ‡æ ‡ | åˆ†è¡¨å‰ | åˆ†è¡¨å | æå‡å¹…åº¦ |
|------|--------|--------|----------|
| å­¦ç”ŸæŸ¥è¯¢å“åº”æ—¶é—´ | 500ms | 50ms | 90% |
| æˆç»©æŸ¥è¯¢å“åº”æ—¶é—´ | 800ms | 80ms | 90% |
| è€ƒå‹¤è®°å½•æ’å…¥ | 200ms | 20ms | 90% |
| æ•°æ®åº“è¿æ¥æ•° | 80% | 40% | 50% |

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·è”ç³»ï¼š
- DBAè´Ÿè´£äººï¼š[å§“å]
- åç«¯è´Ÿè´£äººï¼š[å§“å]
- é‚®ç®±ï¼š[é‚®ç®±åœ°å€]
