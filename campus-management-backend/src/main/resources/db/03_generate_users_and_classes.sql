-- =====================================================
-- Smart Campus Management System - 用户和班级数据生成脚本 (修复版)
-- 文件: 03_generate_users_and_classes.sql
-- 描述: 生成合理规模的用户和班级数据
-- 数据规模: 15,000个用户 + 200个班级
-- 用户分布: 50管理员 + 500教师 + 200班主任 + 10,000学生 + 4,250家长
-- 版本: 3.0.0 (修复版)
-- 创建时间: 2025-01-27
-- 编码: UTF-8
-- =====================================================

-- 设置字符编码
SET NAMES utf8mb4;
SET CHARACTER SET utf8mb4;

-- 使用数据库
USE campus_management_db;

-- 设置优化参数
SET autocommit = 0;
SET unique_checks = 0;
SET foreign_key_checks = 0;

-- =====================================================
-- 高性能批量数据生成 - 使用临时表和批量INSERT
-- =====================================================

-- 创建临时表用于生成序列号
DROP TEMPORARY TABLE IF EXISTS temp_numbers;
CREATE TEMPORARY TABLE temp_numbers (
    num INT PRIMARY KEY
);

-- 生成1到20000的序列号（足够支持15,000用户）
INSERT INTO temp_numbers (num)
SELECT a.N + b.N * 10 + c.N * 100 + d.N * 1000 + e.N * 10000 + 1 as number_val
FROM
    (SELECT 0 as N UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) a,
    (SELECT 0 as N UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) b,
    (SELECT 0 as N UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) c,
    (SELECT 0 as N UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) d,
    (SELECT 0 as N UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) e
WHERE (a.N + b.N * 10 + c.N * 100 + d.N * 1000 + e.N * 10000 + 1) <= 20000;

-- 创建姓名数据表
DROP TEMPORARY TABLE IF EXISTS temp_surnames;
CREATE TEMPORARY TABLE temp_surnames (
    id INT AUTO_INCREMENT PRIMARY KEY,
    surname VARCHAR(10)
);

INSERT INTO temp_surnames (surname) VALUES
('王'),('李'),('张'),('刘'),('陈'),('杨'),('黄'),('赵'),('周'),('吴'),
('徐'),('孙'),('朱'),('马'),('胡'),('郭'),('林'),('何'),('高'),('梁'),
('郑'),('罗'),('宋'),('谢'),('唐'),('韩'),('曹'),('许'),('邓'),('萧'),
('冯'),('曾'),('程'),('蔡'),('彭'),('潘'),('袁'),('于'),('董'),('余'),
('苏'),('叶'),('吕'),('魏'),('蒋'),('田'),('杜'),('丁'),('沈'),('姜'),
('范'),('江'),('傅'),('钟'),('卢'),('汪'),('戴'),('崔'),('任'),('陆'),
('廖'),('姚'),('方'),('金'),('邱'),('夏'),('谭'),('韦'),('贾'),('邹'),
('石'),('熊'),('孟'),('秦'),('阎'),('薛'),('侯'),('雷'),('白'),('龙'),
('段'),('郝'),('孔'),('邵'),('史'),('毛'),('常'),('万'),('顾'),('赖'),
('武'),('康'),('贺'),('严'),('尹'),('钱'),('施'),('牛'),('洪'),('龚'),
-- ========== 新增姓氏 ==========
-- 🔥 常见姓氏补充（按人口数量排序）
('温'),('莫'),('蓝'),('甘'),('易'),('华'),('欧'),('柯'),('卜'),('路'),
('聂'),('关'),('苗'),('池'),('向'),('时'),('包'),('司'),('柳'),('黎'),
-- 📚 经典百家姓补充
('鲁'),('韦'),('昌'),('马'),('苏'),('孔'),('曹'),('严'),('华'),('金'),
('魏'),('陶'),('姜'),('戚'),('谢'),('邹'),('喻'),('柏'),('水'),('窦'),
('章'),('云'),('苏'),('潘'),('葛'),('奚'),('范'),('彭'),('郎'),('鲁'),
-- 🌟 复姓
('欧阳'),('太史'),('端木'),('上官'),('司马'),('东方'),('独孤'),('南宫'),
('万俟'),('闻人'),('夏侯'),('诸葛'),('尉迟'),('公羊'),('赫连'),('澹台'),
('皇甫'),('宗政'),('濮阳'),('公冶'),('太叔'),('申屠'),('公孙'),('慕容'),
('仲孙'),('钟离'),('长孙'),('宇文'),('司徒'),('鲜于'),('司空'),('闾丘'),
('子车'),('亓官'),('司寇'),('巫马'),('公西'),('颛孙'),('壤驷'),('公良'),
('漆雕'),('乐正'),('宰父'),('谷梁'),('拓跋'),('夹谷'),('轩辕'),('令狐'),
('徐离'),('宗正'),('公户'),('公玉'),('公仪'),('梁丘'),('公门'),('公山'),
-- 🏛️ 历史名门望族姓氏
('谯'),('寇'),('全'),('费'),('廉'),('岑'),('薄'),('裘'),('单'),('饶'),
('布'),('鄂'),('位'),('覃'),('霍'),('翁'),('隋'),('植'),('甄'),('景'),
('普'),('晏'),('冀'),('宫'),('宁'),('仇'),('栾'),('暴'),('甘'),('钭'),
('厉'),('戎'),('祖'),('武'),('符'),('刘'),('景'),('詹'),('束'),('龙'),
-- 🌸 文雅姓氏
('花'),('苗'),('兰'),('竹'),('梅'),('菊'),('莲'),('荷'),('桂'),('樱'),
('柳'),('杨'),('槐'),('桃'),('李'),('杏'),('梨'),('橘'),('柑'),('枫'),
('松'),('柏'),('桐'),('榆'),('楠'),('檀'),('椿'),('桢'),('栋'),('梓'),
-- 🎨 色彩姓氏
('红'),('绿'),('蓝'),('紫'),('黑'),('白'),('灰'),('黄'),('青'),('橙'),
('粉'),('银'),('金'),('铜'),('铁'),('钢'),('玉'),('珠'),('翠'),('碧'),
-- 🏔️ 地理姓氏
('山'),('河'),('海'),('湖'),('江'),('溪'),('泉'),('池'),('沼'),('渊'),
('岭'),('峰'),('岩'),('石'),('土'),('沙'),('泥'),('尘'),('雾'),('云'),
('天'),('地'),('日'),('月'),('星'),('辰'),('风'),('雨'),('雪'),('霜'),
-- 🐲 动物姓氏
('龙'),('凤'),('虎'),('狮'),('豹'),('鹿'),('马'),('牛'),('羊'),('猪'),
('狗'),('猫'),('鼠'),('兔'),('蛇'),('鸡'),('鸭'),('鹅'),('鱼'),('鸟'),
('鹰'),('雁'),('燕'),('鸽'),('鹤'),('孔'),('雀'),('蝶'),('蜂'),('蚁'),
-- 💎 珍宝姓氏
('宝'),('珍'),('玉'),('金'),('银'),('铜'),('铁'),('钢'),('石'),('玛'),
('瑙'),('翡'),('翠'),('琼'),('璧'),('璜'),('琪'),('琳'),('瑜'),('瑕'),
('珊'),('瑚'),('琅'),('琊'),('璃'),('琉'),('璇'),('玑'),('珠'),('宝'),
-- 🏺 古代官职姓氏
('司'),('史'),('师'),('尹'),('宰'),('令'),('长'),('守'),('丞'),('尉'),
('校'),('将'),('军'),('侯'),('公'),('王'),('帝'),('皇'),('君'),('主'),
('臣'),('卿'),('大'),('太'),('少'),('中'),('内'),('外'),('左'),('右'),
-- 🌅 时间方位姓氏
('东'),('南'),('西'),('北'),('中'),('上'),('下'),('前'),('后'),('左'),
('右'),('内'),('外'),('高'),('低'),('远'),('近'),('新'),('老'),('古'),
('今'),('春'),('夏'),('秋'),('冬'),('朝'),('夕'),('昼'),('夜'),('晨'),
-- 🎭 特殊单字姓氏
('乜'),('九'),('乞'),('也'),('习'),('乡'),('买'),('云'),('企'),('伊'),
('伍'),('伏'),('伦'),('但'),('佘'),('余'),('佴'),('佶'),('侍'),('便'),
('俞'),('保'),('信'),('修'),('倪'),('偶'),('储'),('僪'),('光'),('党'),
('兜'),('兰'),('关'),('兴'),('兵'),('其'),('具'),('冉'),('冼'),('凃'),
-- 🏮 民族特色姓氏
('阿'),('巴'),('白'),('包'),('布'),('察'),('朝'),('陈'),('迟'),('褚'),
('达'),('大'),('代'),('单'),('邓'),('第'),('丁'),('东'),('都'),('端'),
('尔'),('法'),('范'),('费'),('丰'),('冯'),('佛'),('富'),('高'),('格'),
('根'),('弓'),('古'),('固'),('关'),('官'),('管'),('贵'),('郭'),('哈'),
-- 🎪 稀有姓氏
('鸡'),('狗'),('猪'),('死'),('毒'),('黑'),('臭'),('粪'),('屎'),('尿'),
('鬼'),('魔'),('妖'),('怪'),('邪'),('恶'),('坏'),('丑'),('脏'),('臭'),
('哭'),('笑'),('怒'),('喜'),('愁'),('乐'),('悲'),('欢'),('爱'),('恨'),
-- 🌺 现代姓氏
('计'),('米'),('伊'),('印'),('危'),('即'),('却'),('卷'),('原'),('厚'),
('叶'),('听'),('咸'),('品'),('哈'),('员'),('哲'),('商'),('啜'),('嘉'),
('图'),('塔'),('墨'),('夷'),('奇'),('女'),('奈'),('委'),('威'),('娄'),
('姬'),('娃'),('嫁'),('宇'),('守'),('宅'),('安'),('宋'),('完'),('宗'),
-- 🎯 网络时代新兴姓氏
('网'),('码'),('数'),('字'),('电'),('脑'),('机'),('器'),('智'),('能'),
('科'),('技'),('信'),('息'),('通'),('讯'),('联'),('网'),('互'),('动'),
('虚'),('拟'),('现'),('实'),('增'),('强'),('人'),('工'),('大'),('据');

DROP TEMPORARY TABLE IF EXISTS temp_given_names;
CREATE TEMPORARY TABLE temp_given_names (
    id INT AUTO_INCREMENT PRIMARY KEY,
    given_name VARCHAR(10),
    gender VARCHAR(5)
);

INSERT INTO temp_given_names (given_name, gender) VALUES
-- 原有100个名字 + 新增名字用字
-- 原有名字（保持不变）
('伟','男'),('强','男'),('磊','男'),('军','男'),('勇','男'),('涛','男'),('明','男'),('超','男'),('亮','男'),('华','男'),
('建','男'),('国','男'),('峰','男'),('辉','男'),('成','男'),('龙','男'),('文','男'),('斌','男'),('刚','男'),('健','男'),
('世','男'),('广','男'),('志','男'),('良','男'),('海','男'),('山','男'),('仁','男'),('波','男'),('宁','男'),('贵','男'),
('福','男'),('生','男'),('元','男'),('全','男'),('胜','男'),('学','男'),('祥','男'),('才','男'),('发','男'),('武','男'),
('新','男'),('利','男'),('清','男'),('飞','男'),('彬','男'),('富','男'),('顺','男'),('信','男'),('子','男'),('杰','男'),
('芳','女'),('娜','女'),('静','女'),('敏','女'),('雪','女'),('丽','女'),('美','女'),('娟','女'),('英','女'),('华','女'),
('慧','女'),('巧','女'),('淑','女'),('惠','女'),('珠','女'),('翠','女'),('雅','女'),('芝','女'),('玉','女'),('萍','女'),
('红','女'),('娥','女'),('玲','女'),('芬','女'),('燕','女'),('彩','女'),('春','女'),('菊','女'),('兰','女'),('凤','女'),
('洁','女'),('梅','女'),('琳','女'),('素','女'),('云','女'),('莲','女'),('真','女'),('环','女'),('荣','女'),('爱','女'),
('妹','女'),('霞','女'),('香','女'),('月','女'),('莺','女'),('媛','女'),('艳','女'),('瑞','女'),('凡','女'),('佳','女'),

-- ========== 新增男性名字用字 ==========

-- 🔥 现代流行男名
('浩','男'),('宇','男'),('轩','男'),('博','男'),('昊','男'),('然','男'),('睿','男'),('晨','男'),('阳','男'),('煜','男'),
('泽','男'),('凯','男'),('锐','男'),('翔','男'),('鹏','男'),('豪','男'),('旭','男'),('琦','男'),('皓','男'),('晟','男'),
('恒','男'),('航','男'),('乐','男'),('逸','男'),('风','男'),('雨','男'),('林','男'),('森','男'),('江','男'),('河','男'),
('天','男'),('地','男'),('星','男'),('辰','男'),('日','男'),('月','男'),('光','男'),('照','男'),('熙','男'),('炎','男'),

-- 💪 阳刚霸气男名
('威','男'),('猛','男'),('虎','男'),('豹','男'),('狮','男'),('鹰','男'),('隼','男'),('熊','男'),('狼','男'),('剑','男'),
('刀','男'),('枪','男'),('戟','男'),('斧','男'),('锤','男'),('盾','男'),('铠','男'),('甲','男'),('战','男'),('征','男'),
('霸','男'),('王','男'),('帝','男'),('皇','男'),('尊','男'),('圣','男'),('神','男'),('仙','男'),('魔','男'),('鬼','男'),

-- 🌟 文雅男名
('书','男'),('诗','男'),('词','男'),('画','男'),('琴','男'),('棋','男'),('茶','男'),('酒','男'),('香','男'),('墨','男'),
('纸','男'),('笔','男'),('砚','男'),('印','男'),('章','男'),('文','男'),('武','男'),('德','男'),('仁','男'),('义','男'),
('礼','男'),('智','男'),('信','男'),('忠','男'),('孝','男'),('廉','男'),('耻','男'),('温','男'),('良','男'),('恭','男'),
('俭','男'),('让','男'),('谦','男'),('和','男'),('平','男'),('安','男'),('宁','男'),('静','男'),('淡','男'),('雅','男'),

-- 🏆 成功寓意男名
('富','男'),('贵','男'),('荣','男'),('华','男'),('显','男'),('达','男'),('昌','男'),('盛','男'),('兴','男'),('旺','男'),
('发','男'),('财','男'),('宝','男'),('金','男'),('银','男'),('珠','男'),('玉','男'),('钻','男'),('宫','男'),('殿','男'),
('府','男'),('院','男'),('楼','男'),('阁','男'),('轩','男'),('斋','男'),('堂','男'),('室','男'),('舍','男'),('居','男'),

-- 🌱 自然男名
('松','男'),('柏','男'),('竹','男'),('梅','男'),('兰','男'),('菊','男'),('荷','男'),('桂','男'),('樱','男'),('枫','男'),
('柳','男'),('槐','男'),('桃','男'),('李','男'),('杏','男'),('梨','男'),('橘','男'),('柑','男'),('桐','男'),('榆','男'),
('楠','男'),('檀','男'),('椿','男'),('桢','男'),('栋','男'),('梁','男'),('柱','男'),('栋','男'),('梓','男'),('楷','男'),

-- 🎯 志向男名
('志','男'),('向','男'),('标','男'),('的','男'),('程','男'),('途','男'),('路','男'),('道','男'),('径','男'),('桥','男'),
('门','男'),('窗','男'),('梯','男'),('阶','男'),('级','男'),('段','男'),('步','男'),('足','男'),('行','男'),('走','男'),
('跑','男'),('跳','男'),('飞','男'),('翔','男'),('翱','男'),('游','男'),('泳','男'),('漂','男'),('流','男'),('动','男'),

-- ========== 新增女性名字用字 ==========

-- 🌸 现代流行女名
('涵','女'),('欣','女'),('怡','女'),('诗','女'),('语','女'),('梦','女'),('思','女'),('雨','女'),('晴','女'),('雪','女'),
('冰','女'),('霜','女'),('露','女'),('珊','女'),('瑚','女'),('贝','女'),('珍','女'),('宝','女'),('钰','女'),('琪','女'),
('琳','女'),('瑶','女'),('瑾','女'),('璇','女'),('璐','女'),('娅','女'),('嫣','女'),('妍','女'),('嫒','女'),('姝','女'),

-- 💎 珠宝女名
('珠','女'),('宝','女'),('钻','女'),('金','女'),('银','女'),('铜','女'),('铁','女'),('玉','女'),('翡','女'),('翠','女'),
('琼','女'),('璧','女'),('璜','女'),('琪','女'),('琳','女'),('瑜','女'),('瑕','女'),('玛','女'),('瑙','女'),('珊','女'),
('瑚','女'),('琅','女'),('琊','女'),('璃','女'),('琉','女'),('璇','女'),('玑','女'),('珞','女'),('璎','女'),('珈','女'),

-- 🌺 花卉女名
('花','女'),('朵','女'),('蕾','女'),('苞','女'),('蕊','女'),('瓣','女'),('叶','女'),('枝','女'),('茎','女'),('根','女'),
('芽','女'),('苗','女'),('草','女'),('藤','女'),('蔓','女'),('萝','女'),('藓','女'),('苔','女'),('菌','女'),('芝','女'),
('蓉','女'),('薇','女'),('蔷','女'),('薔','女'),('玫','女'),('瑰','女'),('丹','女'),('芍','女'),('药','女'),('芨','女'),

-- 🦋 动物女名
('燕','女'),('雀','女'),('莺','女'),('鸽','女'),('鹤','女'),('凤','女'),('凰','女'),('鸾','女'),('鹏','女'),('雁','女'),
('鸳','女'),('鸯','女'),('鸂','女'),('鶎','女'),('鸥','女'),('鹭','女'),('鹳','女'),('鹪','女'),('鹩','女'),('鸾','女'),
('蝶','女'),('蛾','女'),('蜂','女'),('蜜','女'),('蚕','女'),('茧','女'),('蛹','女'),('虫','女'),('螳','女'),('螂','女'),

-- 🌙 天象女名
('日','女'),('月','女'),('星','女'),('辰','女'),('宿','女'),('宵','女'),('夜','女'),('晨','女'),('昏','女'),('暮','女'),
('朝','女'),('夕','女'),('阳','女'),('阴','女'),('晴','女'),('阴','女'),('雨','女'),('雪','女'),('霜','女'),('露','女'),
('雾','女'),('霞','女'),('虹','女'),('彩','女'),('云','女'),('霄','女'),('天','女'),('穹','女'),('宇','女'),('宙','女'),

-- 🎵 音乐女名
('音','女'),('乐','女'),('歌','女'),('舞','女'),('琴','女'),('瑟','女'),('筝','女'),('箫','女'),('笛','女'),('鼓','女'),
('钟','女'),('铃','女'),('磬','女'),('锣','女'),('镲','女'),('号','女'),('喇','女'),('叭','女'),('管','女'),('弦','女'),
('键','女'),('谱','女'),('曲','女'),('调','女'),('律','女'),('韵','女'),('拍','女'),('节','女'),('奏','女'),('唱','女'),

-- 👗 服饰女名
('衣','女'),('裳','女'),('裙','女'),('袍','女'),('袂','女'),('袖','女'),('领','女'),('襟','女'),('带','女'),('绸','女'),
('缎','女'),('绢','女'),('纱','女'),('丝','女'),('绸','女'),('锦','女'),('绮','女'),('罗','女'),('绡','女'),('縠','女'),
('纺','女'),('织','女'),('绣','女'),('缀','女'),('缝','女'),('裁','女'),('剪','女'),('针','女'),('线','女'),('扣','女'),

-- 🏺 器物女名
('瓶','女'),('瓮','女'),('罐','女'),('坛','女'),('盆','女'),('盘','女'),('碗','女'),('碟','女'),('杯','女'),('盏','女'),
('壶','女'),('茶','女'),('酒','女'),('水','女'),('油','女'),('醋','女'),('盐','女'),('糖','女'),('米','女'),('面','女'),
('粉','女'),('粒','女'),('粒','女'),('粒','女'),('粒','女'),('粒','女'),('粒','女'),('粒','女'),('粒','女'),('粒','女'),

-- 🎨 颜色女名
('红','女'),('橙','女'),('黄','女'),('绿','女'),('青','女'),('蓝','女'),('紫','女'),('粉','女'),('白','女'),('黑','女'),
('灰','女'),('棕','女'),('银','女'),('金','女'),('铜','女'),('铁','女'),('钢','女'),('玉','女'),('翠','女'),('碧','女'),
('丹','女'),('朱','女'),('赤','女'),('绛','女'),('紫','女'),('青','女'),('苍','女'),('翠','女'),('碧','女'),('蓝','女'),

-- 📚 文化女名
('书','女'),('画','女'),('诗','女'),('词','女'),('赋','女'),('文','女'),('章','女'),('篇','女'),('页','女'),('行','女'),
('字','女'),('句','女'),('词','女'),('语','女'),('话','女'),('言','女'),('声','女'),('音','女'),('韵','女'),('调','女'),
('笔','女'),('墨','女'),('纸','女'),('砚','女'),('印','女'),('章','女'),('符','女'),('号','女'),('记','女'),('录','女'),

-- 🌈 情感女名
('爱','女'),('恋','女'),('情','女'),('意','女'),('心','女'),('思','女'),('念','女'),('想','女'),('望','女'),('盼','女'),
('愿','女'),('希','女'),('求','女'),('愿','女'),('祈','女'),('祷','女'),('祝','女'),('福','女'),('禧','女'),('庆','女'),
('喜','女'),('乐','女'),('欢','女'),('悦','女'),('愉','女'),('快','女'),('畅','女'),('舒','女'),('怡','女'),('宜','女'),

-- ========== 通用名字用字 ==========

-- 🎯 品德修养类（男女通用）
('德','通用'),('仁','通用'),('义','通用'),('礼','通用'),('智','通用'),('信','通用'),('忠','通用'),('孝','通用'),
('廉','通用'),('耻','通用'),('温','通用'),('良','通用'),('恭','通用'),('俭','通用'),('让','通用'),('谦','通用'),
('和','通用'),('平','通用'),('安','通用'),('宁','通用'),('静','通用'),('淡','通用'),('雅','通用'),('正','通用'),

-- 🌟 吉祥寓意类（男女通用）
('福','通用'),('禄','通用'),('寿','通用'),('喜','通用'),('财','通用'),('宝','通用'),('贵','通用'),('荣','通用'),
('华','通用'),('富','通用'),('康','通用'),('健','通用'),('安','通用'),('泰','通用'),('祥','通用'),('瑞','通用'),
('吉','通用'),('庆','通用'),('禧','通用'),('福','通用'),('恩','通用'),('惠','通用'),('慈','通用'),('善','通用'),

-- 📈 成功进取类（男女通用）
('成','通用'),('功','通用'),('就','通用'),('业','通用'),('立','通用'),('建','通用'),('创','通用'),('新','通用'),
('进','通用'),('步','通用'),('升','通用'),('高','通用'),('远','通用'),('达','通用'),('通','通用'),('畅','通用'),
('顺','通用'),('利','通用'),('胜','通用'),('赢','通用'),('超','通用'),('越','通用'),('优','通用'),('秀','通用'),

-- 🎓 学识智慧类（男女通用）
('学','通用'),('习','通用'),('知','通用'),('识','通用'),('智','通用'),('慧','通用'),('聪','通用'),('明','通用'),
('亮','通用'),('清','通用'),('楚','通用'),('白','通用'),('晓','通用'),('悟','通用'),('通','通用'),('达','通用'),
('博','通用'),('深','通用'),('广','通用'),('泛','通用'),('精','通用'),('细','通用'),('微','通用'),('妙','通用');


-- =====================================================
-- 高性能批量生成用户数据 (合理规模)
-- =====================================================

SELECT '开始生成用户数据...' as '状态', NOW() as '时间';

-- 生成50个管理员用户
INSERT INTO tb_user (username, password, email, real_name, phone, gender, status, deleted)
SELECT
    CONCAT('admin', LPAD(100000 + num, 6, '0')) as username,
    '$2a$10$N.zmdr9k7uOCQb376NoUnuTJ8iKXIGfZEKtY5iHNrXqPHNmzNVjIK' as password,
    CONCAT('admin', LPAD(100000 + num, 6, '0'), '@university.edu.cn') as email,
    CONCAT(s.surname, g.given_name) as real_name,
    CONCAT('1', FLOOR(3 + (num % 6)), LPAD(FLOOR(RAND() * 100000000), 8, '0')) as phone,
    CASE WHEN num % 2 = 0 THEN '男' ELSE '女' END as gender,
    CASE WHEN num % 25 = 0 THEN 0 ELSE 1 END as status,
    0 as deleted
FROM temp_numbers n
JOIN temp_surnames s ON s.id = (n.num % 200) + 1
JOIN temp_given_names g ON g.id = (n.num % 300) + 1
WHERE n.num <= 50;

SELECT '✓ 管理员用户生成完成' as '状态', NOW() as '时间';

-- 生成500个教师用户
INSERT INTO tb_user (username, password, email, real_name, phone, gender, status, deleted)
SELECT
    CONCAT('teacher', LPAD(200000 + num, 6, '0')) as username,
    '$2a$10$N.zmdr9k7uOCQb376NoUnuTJ8iKXIGfZEKtY5iHNrXqPHNmzNVjIK' as password,
    CONCAT('teacher', LPAD(200000 + num, 6, '0'), '@university.edu.cn') as email,
    CONCAT(s.surname, g.given_name) as real_name,
    CONCAT('1', FLOOR(3 + (num % 6)), LPAD(FLOOR(RAND() * 100000000), 8, '0')) as phone,
    g.gender as gender,
    CASE WHEN num % 25 = 0 THEN 0 ELSE 1 END as status,
    0 as deleted
FROM temp_numbers n
JOIN temp_surnames s ON s.id = (n.num % 200) + 1
JOIN temp_given_names g ON g.id = (n.num % 300) + 1
WHERE n.num <= 500;

SELECT '✓ 教师用户生成完成' as '状态', NOW() as '时间';

-- 生成200个班主任用户
INSERT INTO tb_user (username, password, email, real_name, phone, gender, status, deleted)
SELECT
    CONCAT('classteacher', LPAD(300000 + num, 6, '0')) as username,
    '$2a$10$N.zmdr9k7uOCQb376NoUnuTJ8iKXIGfZEKtY5iHNrXqPHNmzNVjIK' as password,
    CONCAT('classteacher', LPAD(300000 + num, 6, '0'), '@university.edu.cn') as email,
    CONCAT(s.surname, g.given_name) as real_name,
    CONCAT('1', FLOOR(3 + (num % 6)), LPAD(FLOOR(RAND() * 100000000), 8, '0')) as phone,
    g.gender as gender,
    CASE WHEN num % 25 = 0 THEN 0 ELSE 1 END as status,
    0 as deleted
FROM temp_numbers n
JOIN temp_surnames s ON s.id = (n.num % 200) + 1
JOIN temp_given_names g ON g.id = (n.num % 300) + 1
WHERE n.num <= 200;

SELECT '✓ 班主任用户生成完成' as '状态', NOW() as '时间';

-- 生成10000个学生用户
INSERT INTO tb_user (username, password, email, real_name, phone, gender, status, deleted)
SELECT
    CONCAT('student', LPAD(400000 + num, 6, '0')) as username,
    '$2a$10$N.zmdr9k7uOCQb376NoUnuTJ8iKXIGfZEKtY5iHNrXqPHNmzNVjIK' as password,
    CONCAT('student', LPAD(400000 + num, 6, '0'), '@university.edu.cn') as email,
    CONCAT(s.surname, g.given_name) as real_name,
    CONCAT('1', FLOOR(3 + (num % 6)), LPAD(FLOOR(RAND() * 100000000), 8, '0')) as phone,
    g.gender as gender,
    CASE WHEN num % 50 = 0 THEN 0 ELSE 1 END as status,
    0 as deleted
FROM temp_numbers n
JOIN temp_surnames s ON s.id = (n.num % 200) + 1
JOIN temp_given_names g ON g.id = (n.num % 300) + 1
WHERE n.num <= 10000;

SELECT '✓ 学生用户生成完成' as '状态', NOW() as '时间';

-- 生成4250个家长用户 (约42.5%的学生有家长账户)
INSERT INTO tb_user (username, password, email, real_name, phone, gender, status, deleted)
SELECT
    CONCAT('parent', LPAD(500000 + num, 6, '0')) as username,
    '$2a$10$N.zmdr9k7uOCQb376NoUnuTJ8iKXIGfZEKtY5iHNrXqPHNmzNVjIK' as password,
    CONCAT('parent', LPAD(500000 + num, 6, '0'), '@university.edu.cn') as email,
    CONCAT(s.surname, g.given_name) as real_name,
    CONCAT('1', FLOOR(3 + (num % 6)), LPAD(FLOOR(RAND() * 100000000), 8, '0')) as phone,
    g.gender as gender,
    CASE WHEN num % 50 = 0 THEN 0 ELSE 1 END as status,
    0 as deleted
FROM temp_numbers n
JOIN temp_surnames s ON s.id = (n.num % 200) + 1
JOIN temp_given_names g ON g.id = (n.num % 300) + 1
WHERE n.num <= 4250;

SELECT '✓ 家长用户生成完成' as '状态', NOW() as '时间';

-- =====================================================
-- 批量分配用户角色
-- =====================================================

-- 分配管理员角色
INSERT INTO tb_user_role (user_id, role_id, status, deleted)
SELECT u.id, r.id, 1, 0
FROM tb_user u
JOIN tb_role r ON r.role_key = 'ROLE_ADMIN'
WHERE u.username LIKE 'admin%' AND u.deleted = 0;

-- 分配教师角色
INSERT INTO tb_user_role (user_id, role_id, status, deleted)
SELECT u.id, r.id, 1, 0
FROM tb_user u
JOIN tb_role r ON r.role_key = 'ROLE_TEACHER'
WHERE u.username LIKE 'teacher%' AND u.deleted = 0;

-- 分配班主任角色
INSERT INTO tb_user_role (user_id, role_id, status, deleted)
SELECT u.id, r.id, 1, 0
FROM tb_user u
JOIN tb_role r ON r.role_key = 'ROLE_CLASS_TEACHER'
WHERE u.username LIKE 'classteacher%' AND u.deleted = 0;

-- 分配学生角色
INSERT INTO tb_user_role (user_id, role_id, status, deleted)
SELECT u.id, r.id, 1, 0
FROM tb_user u
JOIN tb_role r ON r.role_key = 'ROLE_STUDENT'
WHERE u.username LIKE 'student%' AND u.deleted = 0;

-- 分配家长角色
INSERT INTO tb_user_role (user_id, role_id, status, deleted)
SELECT u.id, r.id, 1, 0
FROM tb_user u
JOIN tb_role r ON r.role_key = 'ROLE_PARENT'
WHERE u.username LIKE 'parent%' AND u.deleted = 0;

-- =====================================================
-- 高性能批量生成班级数据
-- =====================================================

-- 创建专业临时表
DROP TEMPORARY TABLE IF EXISTS temp_majors;
CREATE TEMPORARY TABLE temp_majors (
    id INT AUTO_INCREMENT PRIMARY KEY,
    major_name VARCHAR(100)
);

INSERT INTO temp_majors (major_name) VALUES
('计算机科学与技术'),('软件工程'),('网络工程'),('信息安全'),('数据科学与大数据技术'),
('人工智能'),('物联网工程'),('数字媒体技术'),('机械设计制造及其自动化'),('机械电子工程'),
('车辆工程'),('工业设计'),('电子信息工程'),('通信工程'),('自动化'),
('电气工程及其自动化'),('工商管理'),('市场营销'),('国际经济与贸易'),('会计学'),
('财务管理'),('英语'),('日语'),('德语'),('法语'),
('数学与应用数学'),('统计学'),('应用物理学'),('化学'),('生物科学'),
('材料科学与工程'),('土木工程'),('建筑学'),('环境工程'),('能源与动力工程'),
('交通运输'),('航空航天工程'),('海洋工程与技术'),('临床医学'),('法学'),
('汉语言文学'),('新闻学'),('音乐学'),('美术学'),('体育教育'),
('思想政治教育'),('教育学'),('心理学'),
-- ========== 新增专业 ==========
-- 🖥️ 计算机与信息技术类
('信息管理与信息系统'),('智能科学与技术'),('区块链工程'),('网络空间安全'),
('虚拟现实技术'),('游戏设计'),('移动应用开发'),('云计算技术'),
('信息与计算科学'),('空间信息与数字技术'),('计算机视觉'),('机器学习'),
-- 🏗️ 工程技术类
('测绘工程'),('地质工程'),('水利水电工程'),('给排水科学与工程'),
('城乡规划'),('风景园林'),('安全工程'),('消防工程'),
('核工程与核技术'),('石油工程'),('矿物加工工程'),('冶金工程'),
('纺织工程'),('轻化工程'),('包装工程'),('印刷工程'),
('食品科学与工程'),('生物工程'),('制药工程'),('化学工程与工艺'),
('智能制造工程'),('机器人工程'),('新能源科学与工程'),
('光电信息科学与工程'),('微电子科学与工程'),('集成电路设计与集成系统'),
-- 🏥 医学类
('口腔医学'),('预防医学'),('中医学'),('中西医临床医学'),
('针灸推拿学'),('中药学'),('药学'),('药物制剂'),
('医学检验技术'),('医学影像技术'),('康复治疗学'),('护理学'),
('麻醉学'),('眼视光医学'),('精神医学'),('儿科学'),
('生物医学工程'),('医学信息工程'),('智能医学工程'),
('健康服务与管理'),('卫生检验与检疫'),
-- 📈 经济管理类
('经济学'),('金融学'),('金融工程'),('保险学'),
('投资学'),('税收学'),('贸易经济'),('电子商务'),
('物流管理'),('供应链管理'),('人力资源管理'),('行政管理'),
('公共事业管理'),('劳动与社会保障'),('土地资源管理'),('城市管理'),
('档案学'),('信息资源管理'),('农林经济管理'),('旅游管理'),
('酒店管理'),('会展经济与管理'),('国际商务'),('审计学'),
('资产评估'),('房地产开发与管理'),('工程管理'),('工程造价'),
-- 🌱 农林类
('农学'),('园艺'),('植物保护'),('茶学'),
('林学'),('园林'),('水产养殖学'),('动物科学'),
('动物医学'),('草业科学'),('农业资源与环境'),('食品质量与安全'),
('设施农业科学与工程'),('农业机械化及其自动化'),('森林保护'),
('水土保持与荒漠化防治'),('农业水利工程'),
-- 🎨 艺术设计类
('视觉传达设计'),('环境设计'),('产品设计'),('服装与服饰设计'),
('动画'),('数字媒体艺术'),('摄影'),('书法学'),
('舞蹈学'),('戏剧影视文学'),('广播电视编导'),('播音与主持艺术'),
('影视摄影与制作'),('艺术与科技'),('工艺美术'),('雕塑'),
('绘画'),('中国画'),('油画'),('版画'),('水彩'),
('艺术设计学'),('艺术史论'),
-- 📚 文史哲类
('历史学'),('考古学'),('文物与博物馆学'),('哲学'),
('逻辑学'),('宗教学'),('伦理学'),('秘书学'),
('古典文献学'),('应用语言学'),('翻译'),('商务英语'),
('朝鲜语'),('俄语'),('西班牙语'),('阿拉伯语'),('葡萄牙语'),
('意大利语'),('泰语'),('越南语'),('缅甸语'),('老挝语'),
('柬埔寨语'),('马来语'),('僧伽罗语'),('土耳其语'),('希腊语'),
('匈牙利语'),('捷克语'),('波兰语'),('克罗地亚语'),
-- 🔬 理学类
('物理学'),('理论与应用力学'),('地理科学'),('人文地理与城乡规划'),
('地理信息科学'),('大气科学'),('海洋科学'),('地球物理学'),
('地质学'),('应用心理学'),('天文学'),('生物技术'),
('生物信息学'),('生态学'),('海洋技术'),('海洋资源与环境'),
('地球化学'),('地球信息科学与技术'),('分子科学与工程'),
-- ⚖️ 法学社会学类
('政治学与行政学'),('国际政治'),('外交学'),('社会学'),
('社会工作'),('人类学'),('女性学'),('家政学'),
('知识产权'),('监狱学'),('治安学'),('侦查学'),
('边防管理'),('火灾勘查'),('禁毒学'),('警犬技术'),
('经济犯罪侦查'),('边防指挥'),('消防指挥'),('警卫学'),
('公安情报学'),('犯罪学'),('公安管理学'),
-- 🏃 体育类
('运动训练'),('武术与民族传统体育'),('运动人体科学'),('休闲体育'),
('体能训练'),('冰雪运动'),('电子竞技运动与管理'),('智能体育工程'),
('运动康复'),('体育经济与管理'),('社会体育指导与管理'),
-- 🧑‍🏫 教育学类
('小学教育'),('学前教育'),('特殊教育'),('科学教育'),
('人文教育'),('教育技术学'),('艺术教育'),('华文教育'),
('运动训练'),('社会体育指导与管理'),('武术与民族传统体育'),
-- 🌟 新兴交叉学科
('量子信息科学'),('纳米材料与技术'),('新能源材料与器件'),
('智能感知工程'),('脑科学与类脑智能'),('合成生物学'),
('整合科学'),('计算生物学'),('基因工程'),('细胞生物学'),
('分子生物学'),('免疫学'),('病理学与病理生理学'),
('药理学'),('毒理学'),('营养与食品卫生学'),
-- 🌍 国际化与特色专业
('国际关系'),('国际文化交流'),('汉语国际教育'),
('海关管理'),('国际税收'),('跨境电子商务'),
('葡萄与葡萄酒工程'),('马业科学'),('蚕学'),('蜂学'),
('草业科学'),('烟草'),('中草药栽培与鉴定'),('应用生物科学'),
-- 🎭 传媒与艺术补充
('网络与新媒体'),('数字出版'),('时尚传播'),
('戏剧学'),('电影学'),('戏剧影视导演'),('表演'),
('录音艺术'),('作曲与作曲技术理论'),('音乐表演'),
('音乐治疗'),('音响工程'),
-- 💼 现代服务业
('养老服务管理'),('家政学'),('烹饪与营养教育'),
('服装设计与工程'),('服装与服饰设计'),('宝石及材料工艺学'),
('化妆品技术与工程'),('香料香精技术与工程'),
-- 🔋 能源环保类
('新能源科学与工程'),('储能科学与工程'),('氢能科学与工程'),
('环境科学'),('环境生态工程'),('环保设备工程'),
('资源环境科学'),('水质科学与技术'),('环境监察'),
-- 🚗 交通运输补充
('交通工程'),('交通设备与控制工程'),('救助与打捞工程'),
('船舶与海洋工程'),('轮机工程'),('飞行器设计与工程'),
('飞行器制造工程'),('飞行器动力工程'),('飞行器质量与可靠性'),
('飞行器适航技术'),('无人驾驶航空器系统工程'),
-- 🏛️ 公共管理类
('公共关系学'),('城市管理'),('海关管理'),('海事管理'),
('公共政策学'),('国防教育与管理'),('维和学'),
-- 🎪 其他特色专业
('马克思主义理论'),('科学社会主义'),('中国共产党历史'),
('国际组织与全球治理'),('纪检监察'),('海警执法'),
('涉外警务'),('警务指挥与战术'),('网络安全与执法'),
('数据警务技术'),('食品营养与检验教育'),('应用生物教育'),
('生物技术及应用'),('生物化学与分子生物学');

-- 批量生成800个班级
INSERT INTO tb_school_class (class_name, class_code, department_id, major, grade, enrollment_year, student_count, max_capacity, status, deleted)
SELECT
    CONCAT(year_val, '级', SUBSTRING(m.major_name, 1, 4), class_num, '班') as class_name,
    CONCAT(d.department_code, year_val, LPAD(m.id, 3, '0'), LPAD(class_num, 2, '0')) as class_code,
    d.id as department_id,
    m.major_name as major,
    CONCAT(year_val, '级') as grade,
    year_val as enrollment_year,
    0 as student_count,
    50 as max_capacity,
    1 as status,
    0 as deleted
FROM (
    SELECT 2021 as year_val UNION SELECT 2022 UNION SELECT 2023 UNION SELECT 2024 UNION SELECT 2025
) years
CROSS JOIN (
    SELECT 1 as class_num UNION SELECT 2 UNION SELECT 3 UNION SELECT 4
) classes
CROSS JOIN tb_department d
CROSS JOIN temp_majors m
WHERE d.deleted = 0 AND d.status = 1
AND ((d.id - 1) * 20 + (year_val - 2021) * 4 + class_num) <= 800
ORDER BY d.id, year_val, m.id, class_num;

-- =====================================================
-- 执行数据生成
-- =====================================================

START TRANSACTION;

SELECT '=== 开始生成大规模用户数据 ===' as '状态', NOW() as '时间';

-- 步骤1: 生成管理员用户
SELECT '步骤1: 生成管理员用户...' as '状态', NOW() as '时间';
-- 管理员用户已在上面批量生成
SELECT '✓ 管理员用户生成完成' as '状态', NOW() as '时间';

-- 步骤2: 生成教师用户
SELECT '步骤2: 生成教师用户...' as '状态', NOW() as '时间';
-- 教师用户已在上面批量生成
SELECT '✓ 教师用户生成完成' as '状态', NOW() as '时间';

-- 步骤3: 生成班主任用户
SELECT '步骤3: 生成班主任用户...' as '状态', NOW() as '时间';
-- 班主任用户已在上面批量生成
SELECT '✓ 班主任用户生成完成' as '状态', NOW() as '时间';

-- 步骤4: 生成学生用户
SELECT '步骤4: 生成学生用户...' as '状态', NOW() as '时间';
-- 学生用户已在上面批量生成
SELECT '✓ 学生用户生成完成' as '状态', NOW() as '时间';

-- 步骤5: 生成家长用户
SELECT '步骤5: 生成家长用户...' as '状态', NOW() as '时间';
-- 家长用户已在上面批量生成
SELECT '✓ 家长用户生成完成' as '状态', NOW() as '时间';

-- 步骤6: 生成班级数据
SELECT '步骤6: 生成班级数据...' as '状态', NOW() as '时间';
-- 班级数据已在上面批量生成
SELECT '✓ 班级数据生成完成' as '状态', NOW() as '时间';

-- 恢复设置
SET foreign_key_checks = 1;
SET unique_checks = 1;
SET autocommit = 1;

COMMIT;

-- 显示统计信息
SELECT '=== 用户和班级数据生成完成 ===' as '状态', NOW() as '时间';

SELECT 
    r.role_name as '角色类型',
    COUNT(ur.user_id) as '用户数量'
FROM tb_role r
LEFT JOIN tb_user_role ur ON r.id = ur.role_id
LEFT JOIN tb_user u ON ur.user_id = u.id AND u.deleted = 0
WHERE r.deleted = 0
GROUP BY r.id, r.role_name
ORDER BY COUNT(ur.user_id) DESC;

SELECT COUNT(*) as '总班级数量' FROM tb_school_class WHERE deleted = 0;

SELECT '✓ 大规模用户和班级数据生成完成' as '状态', NOW() as '时间';

-- 清理临时表
DROP TEMPORARY TABLE IF EXISTS temp_numbers;
DROP TEMPORARY TABLE IF EXISTS temp_surnames;
DROP TEMPORARY TABLE IF EXISTS temp_given_names;
DROP TEMPORARY TABLE IF EXISTS temp_majors;
