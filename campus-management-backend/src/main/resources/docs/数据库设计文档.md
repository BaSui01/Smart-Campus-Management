# ğŸ—„ï¸ æ™ºæ…§æ ¡å›­ç®¡ç†ç³»ç»Ÿæ•°æ®åº“è®¾è®¡æ–‡æ¡£

## ğŸ“‹ æ¦‚è¿°

æœ¬æ–‡æ¡£è¯¦ç»†æè¿°äº†æ™ºæ…§æ ¡å›­ç®¡ç†ç³»ç»Ÿçš„æ•°æ®åº“è®¾è®¡ï¼ŒåŒ…æ‹¬è¡¨ç»“æ„ã€å­—æ®µè¯´æ˜ã€ç´¢å¼•è®¾è®¡ã€å…³ç³»å›¾ç­‰å†…å®¹ã€‚

### è®¾è®¡åŸåˆ™
- **è§„èŒƒåŒ–**: éµå¾ªç¬¬ä¸‰èŒƒå¼ï¼Œå‡å°‘æ•°æ®å†—ä½™
- **æ€§èƒ½ä¼˜åŒ–**: åˆç†è®¾è®¡ç´¢å¼•ï¼Œä¼˜åŒ–æŸ¥è¯¢æ€§èƒ½
- **æ‰©å±•æ€§**: é¢„ç•™æ‰©å±•å­—æ®µï¼Œæ”¯æŒä¸šåŠ¡å‘å±•
- **å®‰å…¨æ€§**: æ•æ„Ÿæ•°æ®åŠ å¯†ï¼Œæ”¯æŒè½¯åˆ é™¤

### æ•°æ®åº“ä¿¡æ¯
- **æ•°æ®åº“ç±»å‹**: MySQL 8.0
- **å­—ç¬¦é›†**: utf8mb4
- **æ’åºè§„åˆ™**: utf8mb4_unicode_ci
- **å­˜å‚¨å¼•æ“**: InnoDB
- **è¡¨æ•°é‡**: 35å¼ è¡¨

## ğŸ—ï¸ æ•°æ®åº“æ¶æ„

### æ¨¡å—åˆ’åˆ†

```
æ™ºæ…§æ ¡å›­ç®¡ç†ç³»ç»Ÿæ•°æ®åº“
â”œâ”€â”€ æƒé™ç®¡ç†æ¨¡å— (5å¼ è¡¨)
â”‚   â”œâ”€â”€ users (ç”¨æˆ·è¡¨)
â”‚   â”œâ”€â”€ roles (è§’è‰²è¡¨)
â”‚   â”œâ”€â”€ permissions (æƒé™è¡¨)
â”‚   â”œâ”€â”€ user_roles (ç”¨æˆ·è§’è‰²å…³è”è¡¨)
â”‚   â””â”€â”€ role_permissions (è§’è‰²æƒé™å…³è”è¡¨)
â”œâ”€â”€ ç»„ç»‡ç®¡ç†æ¨¡å— (4å¼ è¡¨)
â”‚   â”œâ”€â”€ departments (é™¢ç³»è¡¨)
â”‚   â”œâ”€â”€ school_classes (ç­çº§è¡¨)
â”‚   â”œâ”€â”€ students (å­¦ç”Ÿè¡¨)
â”‚   â””â”€â”€ parent_student_relations (å®¶é•¿å­¦ç”Ÿå…³ç³»è¡¨)
â”œâ”€â”€ å­¦æœ¯ç®¡ç†æ¨¡å— (12å¼ è¡¨)
â”‚   â”œâ”€â”€ courses (è¯¾ç¨‹è¡¨)
â”‚   â”œâ”€â”€ course_schedules (è¯¾ç¨‹å®‰æ’è¡¨)
â”‚   â”œâ”€â”€ course_selections (é€‰è¯¾è¡¨)
â”‚   â”œâ”€â”€ course_selection_periods (é€‰è¯¾å‘¨æœŸè¡¨)
â”‚   â”œâ”€â”€ assignments (ä½œä¸šè¡¨)
â”‚   â”œâ”€â”€ assignment_submissions (ä½œä¸šæäº¤è¡¨)
â”‚   â”œâ”€â”€ exams (è€ƒè¯•è¡¨)
â”‚   â”œâ”€â”€ exam_questions (è€ƒè¯•é¢˜ç›®è¡¨)
â”‚   â”œâ”€â”€ exam_records (è€ƒè¯•è®°å½•è¡¨)
â”‚   â”œâ”€â”€ grades (æˆç»©è¡¨)
â”‚   â”œâ”€â”€ attendance (è€ƒå‹¤è¡¨)
â”‚   â””â”€â”€ course_resources (è¯¾ç¨‹èµ„æºè¡¨)
â”œâ”€â”€ è´¢åŠ¡ç®¡ç†æ¨¡å— (2å¼ è¡¨)
â”‚   â”œâ”€â”€ fee_items (è´¹ç”¨é¡¹ç›®è¡¨)
â”‚   â””â”€â”€ payment_records (ç¼´è´¹è®°å½•è¡¨)
â”œâ”€â”€ ç³»ç»Ÿç®¡ç†æ¨¡å— (6å¼ è¡¨)
â”‚   â”œâ”€â”€ system_configs (ç³»ç»Ÿé…ç½®è¡¨)
â”‚   â”œâ”€â”€ system_settings (ç³»ç»Ÿè®¾ç½®è¡¨)
â”‚   â”œâ”€â”€ notifications (é€šçŸ¥è¡¨)
â”‚   â”œâ”€â”€ notification_templates (é€šçŸ¥æ¨¡æ¿è¡¨)
â”‚   â”œâ”€â”€ messages (æ¶ˆæ¯è¡¨)
â”‚   â””â”€â”€ activity_logs (æ´»åŠ¨æ—¥å¿—è¡¨)
â”œâ”€â”€ åŸºç¡€è®¾æ–½æ¨¡å— (4å¼ è¡¨)
â”‚   â”œâ”€â”€ classrooms (æ•™å®¤è¡¨)
â”‚   â”œâ”€â”€ schedules (æ—¥ç¨‹è¡¨)
â”‚   â”œâ”€â”€ time_slots (æ—¶é—´æ®µè¡¨)
â”‚   â””â”€â”€ resource_access_logs (èµ„æºè®¿é—®æ—¥å¿—è¡¨)
â””â”€â”€ æ‰©å±•åŠŸèƒ½æ¨¡å— (2å¼ è¡¨)
    â”œâ”€â”€ student_evaluations (å­¦ç”Ÿè¯„ä»·è¡¨)
    â””â”€â”€ teacher_course_permissions (æ•™å¸ˆè¯¾ç¨‹æƒé™è¡¨)
```

## ğŸ“Š æ ¸å¿ƒè¡¨ç»“æ„è®¾è®¡

### 1. æƒé™ç®¡ç†æ¨¡å—

#### 1.1 ç”¨æˆ·è¡¨ (users)
```sql
CREATE TABLE users (
    id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT 'ç”¨æˆ·ID',
    username VARCHAR(50) UNIQUE NOT NULL COMMENT 'ç”¨æˆ·å',
    password VARCHAR(255) NOT NULL COMMENT 'å¯†ç (åŠ å¯†)',
    email VARCHAR(100) UNIQUE COMMENT 'é‚®ç®±',
    phone VARCHAR(20) COMMENT 'æ‰‹æœºå·',
    real_name VARCHAR(50) COMMENT 'çœŸå®å§“å',
    avatar VARCHAR(255) COMMENT 'å¤´åƒURL',
    gender TINYINT COMMENT 'æ€§åˆ«: 1-ç”·, 2-å¥³, 0-æœªçŸ¥',
    birth_date DATE COMMENT 'å‡ºç”Ÿæ—¥æœŸ',
    id_card VARCHAR(18) COMMENT 'èº«ä»½è¯å·',
    address VARCHAR(255) COMMENT 'åœ°å€',
    status TINYINT DEFAULT 1 COMMENT 'çŠ¶æ€: 1-æ­£å¸¸, 0-ç¦ç”¨, -1-åˆ é™¤',
    last_login_time DATETIME COMMENT 'æœ€åç™»å½•æ—¶é—´',
    last_login_ip VARCHAR(45) COMMENT 'æœ€åç™»å½•IP',
    login_count INT DEFAULT 0 COMMENT 'ç™»å½•æ¬¡æ•°',
    password_update_time DATETIME COMMENT 'å¯†ç æ›´æ–°æ—¶é—´',
    created_time DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',
    updated_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'æ›´æ–°æ—¶é—´',
    deleted TINYINT DEFAULT 0 COMMENT 'é€»è¾‘åˆ é™¤æ ‡è®°',
    
    INDEX idx_username (username),
    INDEX idx_email (email),
    INDEX idx_phone (phone),
    INDEX idx_status (status),
    INDEX idx_created_time (created_time)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='ç”¨æˆ·è¡¨';
```

#### 1.2 è§’è‰²è¡¨ (roles)
```sql
CREATE TABLE roles (
    id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT 'è§’è‰²ID',
    role_name VARCHAR(50) NOT NULL COMMENT 'è§’è‰²åç§°',
    role_code VARCHAR(50) UNIQUE NOT NULL COMMENT 'è§’è‰²ç¼–ç ',
    description TEXT COMMENT 'è§’è‰²æè¿°',
    role_level INT DEFAULT 0 COMMENT 'è§’è‰²çº§åˆ«',
    parent_id BIGINT COMMENT 'çˆ¶è§’è‰²ID',
    sort_order INT DEFAULT 0 COMMENT 'æ’åº',
    status TINYINT DEFAULT 1 COMMENT 'çŠ¶æ€: 1-å¯ç”¨, 0-ç¦ç”¨',
    created_time DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',
    updated_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'æ›´æ–°æ—¶é—´',
    deleted TINYINT DEFAULT 0 COMMENT 'é€»è¾‘åˆ é™¤æ ‡è®°',
    
    INDEX idx_role_code (role_code),
    INDEX idx_parent_id (parent_id),
    INDEX idx_status (status)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='è§’è‰²è¡¨';
```

#### 1.3 æƒé™è¡¨ (permissions)
```sql
CREATE TABLE permissions (
    id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT 'æƒé™ID',
    permission_name VARCHAR(100) NOT NULL COMMENT 'æƒé™åç§°',
    permission_code VARCHAR(100) UNIQUE NOT NULL COMMENT 'æƒé™ç¼–ç ',
    permission_type VARCHAR(20) COMMENT 'æƒé™ç±»å‹: MENU-èœå•, BUTTON-æŒ‰é’®, API-æ¥å£',
    resource_url VARCHAR(255) COMMENT 'èµ„æºURL',
    method VARCHAR(10) COMMENT 'HTTPæ–¹æ³•',
    parent_id BIGINT COMMENT 'çˆ¶æƒé™ID',
    sort_order INT DEFAULT 0 COMMENT 'æ’åº',
    icon VARCHAR(50) COMMENT 'å›¾æ ‡',
    description TEXT COMMENT 'æƒé™æè¿°',
    status TINYINT DEFAULT 1 COMMENT 'çŠ¶æ€: 1-å¯ç”¨, 0-ç¦ç”¨',
    created_time DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',
    updated_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'æ›´æ–°æ—¶é—´',
    deleted TINYINT DEFAULT 0 COMMENT 'é€»è¾‘åˆ é™¤æ ‡è®°',
    
    INDEX idx_permission_code (permission_code),
    INDEX idx_permission_type (permission_type),
    INDEX idx_parent_id (parent_id),
    INDEX idx_status (status)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='æƒé™è¡¨';
```

### 2. å­¦æœ¯ç®¡ç†æ¨¡å—

#### 2.1 é™¢ç³»è¡¨ (departments)
```sql
CREATE TABLE departments (
    id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT 'é™¢ç³»ID',
    dept_name VARCHAR(100) NOT NULL COMMENT 'é™¢ç³»åç§°',
    dept_code VARCHAR(20) UNIQUE NOT NULL COMMENT 'é™¢ç³»ä»£ç ',
    dept_type VARCHAR(20) COMMENT 'é™¢ç³»ç±»å‹: COLLEGE-å­¦é™¢, DEPARTMENT-ç³», MAJOR-ä¸“ä¸š',
    dept_level INT DEFAULT 1 COMMENT 'é™¢ç³»çº§åˆ«: 1-å­¦é™¢, 2-ç³», 3-ä¸“ä¸š',
    parent_id BIGINT COMMENT 'çˆ¶é™¢ç³»ID',
    dean_id BIGINT COMMENT 'é™¢é•¿/ä¸»ä»»ID',
    contact_phone VARCHAR(20) COMMENT 'è”ç³»ç”µè¯',
    contact_email VARCHAR(100) COMMENT 'è”ç³»é‚®ç®±',
    address VARCHAR(255) COMMENT 'åœ°å€',
    description TEXT COMMENT 'é™¢ç³»æè¿°',
    established_date DATE COMMENT 'æˆç«‹æ—¥æœŸ',
    sort_order INT DEFAULT 0 COMMENT 'æ’åº',
    status TINYINT DEFAULT 1 COMMENT 'çŠ¶æ€: 1-æ­£å¸¸, 0-åœç”¨',
    created_time DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',
    updated_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'æ›´æ–°æ—¶é—´',
    deleted TINYINT DEFAULT 0 COMMENT 'é€»è¾‘åˆ é™¤æ ‡è®°',
    
    INDEX idx_dept_code (dept_code),
    INDEX idx_dept_type (dept_type),
    INDEX idx_parent_id (parent_id),
    INDEX idx_dean_id (dean_id),
    INDEX idx_status (status),
    FOREIGN KEY (parent_id) REFERENCES departments(id),
    FOREIGN KEY (dean_id) REFERENCES users(id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='é™¢ç³»è¡¨';
```

#### 2.2 è¯¾ç¨‹è¡¨ (courses)
```sql
CREATE TABLE courses (
    id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT 'è¯¾ç¨‹ID',
    course_code VARCHAR(20) UNIQUE NOT NULL COMMENT 'è¯¾ç¨‹ä»£ç ',
    course_name VARCHAR(100) NOT NULL COMMENT 'è¯¾ç¨‹åç§°',
    course_name_en VARCHAR(100) COMMENT 'è¯¾ç¨‹è‹±æ–‡åç§°',
    course_type VARCHAR(20) COMMENT 'è¯¾ç¨‹ç±»å‹: REQUIRED-å¿…ä¿®, ELECTIVE-é€‰ä¿®, PUBLIC-å…¬å…±',
    credits DECIMAL(3,1) NOT NULL COMMENT 'å­¦åˆ†',
    hours INTEGER NOT NULL COMMENT 'å­¦æ—¶',
    theory_hours INTEGER COMMENT 'ç†è®ºå­¦æ—¶',
    practice_hours INTEGER COMMENT 'å®è·µå­¦æ—¶',
    department_id BIGINT NOT NULL COMMENT 'æ‰€å±é™¢ç³»ID',
    teacher_id BIGINT COMMENT 'ä¸»è®²æ•™å¸ˆID',
    description TEXT COMMENT 'è¯¾ç¨‹æè¿°',
    objectives TEXT COMMENT 'è¯¾ç¨‹ç›®æ ‡',
    prerequisites VARCHAR(255) COMMENT 'å…ˆä¿®è¯¾ç¨‹',
    textbook VARCHAR(255) COMMENT 'æ•™æ',
    reference_books TEXT COMMENT 'å‚è€ƒä¹¦ç›®',
    assessment_method TEXT COMMENT 'è€ƒæ ¸æ–¹å¼',
    max_students INT DEFAULT 50 COMMENT 'æœ€å¤§é€‰è¯¾äººæ•°',
    min_students INT DEFAULT 10 COMMENT 'æœ€å°å¼€è¯¾äººæ•°',
    difficulty_level TINYINT DEFAULT 1 COMMENT 'éš¾åº¦ç­‰çº§: 1-åˆçº§, 2-ä¸­çº§, 3-é«˜çº§',
    language VARCHAR(20) DEFAULT 'zh-CN' COMMENT 'æˆè¯¾è¯­è¨€',
    status TINYINT DEFAULT 1 COMMENT 'çŠ¶æ€: 1-æ­£å¸¸, 0-åœç”¨',
    created_time DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',
    updated_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'æ›´æ–°æ—¶é—´',
    deleted TINYINT DEFAULT 0 COMMENT 'é€»è¾‘åˆ é™¤æ ‡è®°',
    
    INDEX idx_course_code (course_code),
    INDEX idx_course_name (course_name),
    INDEX idx_course_type (course_type),
    INDEX idx_department_id (department_id),
    INDEX idx_teacher_id (teacher_id),
    INDEX idx_status (status),
    FOREIGN KEY (department_id) REFERENCES departments(id),
    FOREIGN KEY (teacher_id) REFERENCES users(id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='è¯¾ç¨‹è¡¨';
```

#### 2.3 é€‰è¯¾è¡¨ (course_selections)
```sql
CREATE TABLE course_selections (
    id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT 'é€‰è¯¾ID',
    student_id BIGINT NOT NULL COMMENT 'å­¦ç”ŸID',
    course_id BIGINT NOT NULL COMMENT 'è¯¾ç¨‹ID',
    course_schedule_id BIGINT COMMENT 'è¯¾ç¨‹å®‰æ’ID',
    selection_period_id BIGINT COMMENT 'é€‰è¯¾å‘¨æœŸID',
    selection_time DATETIME NOT NULL COMMENT 'é€‰è¯¾æ—¶é—´',
    selection_type VARCHAR(20) DEFAULT 'NORMAL' COMMENT 'é€‰è¯¾ç±»å‹: NORMAL-æ­£å¸¸, MAKEUP-è¡¥é€‰, RETAKE-é‡ä¿®',
    priority INT DEFAULT 0 COMMENT 'é€‰è¯¾ä¼˜å…ˆçº§',
    status VARCHAR(20) DEFAULT 'SELECTED' COMMENT 'çŠ¶æ€: SELECTED-å·²é€‰, DROPPED-å·²é€€, CONFIRMED-å·²ç¡®è®¤',
    drop_time DATETIME COMMENT 'é€€è¯¾æ—¶é—´',
    drop_reason VARCHAR(255) COMMENT 'é€€è¯¾åŸå› ',
    final_score DECIMAL(5,2) COMMENT 'æœ€ç»ˆæˆç»©',
    grade_point DECIMAL(3,2) COMMENT 'ç»©ç‚¹',
    is_passed TINYINT COMMENT 'æ˜¯å¦é€šè¿‡: 1-é€šè¿‡, 0-æœªé€šè¿‡',
    remarks TEXT COMMENT 'å¤‡æ³¨',
    created_time DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',
    updated_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'æ›´æ–°æ—¶é—´',
    deleted TINYINT DEFAULT 0 COMMENT 'é€»è¾‘åˆ é™¤æ ‡è®°',
    
    UNIQUE KEY uk_student_course (student_id, course_id, selection_period_id),
    INDEX idx_student_id (student_id),
    INDEX idx_course_id (course_id),
    INDEX idx_selection_period_id (selection_period_id),
    INDEX idx_selection_time (selection_time),
    INDEX idx_status (status),
    FOREIGN KEY (student_id) REFERENCES students(id),
    FOREIGN KEY (course_id) REFERENCES courses(id),
    FOREIGN KEY (course_schedule_id) REFERENCES course_schedules(id),
    FOREIGN KEY (selection_period_id) REFERENCES course_selection_periods(id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='é€‰è¯¾è¡¨';
```

### 3. è´¢åŠ¡ç®¡ç†æ¨¡å—

#### 3.1 è´¹ç”¨é¡¹ç›®è¡¨ (fee_items)
```sql
CREATE TABLE fee_items (
    id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT 'è´¹ç”¨é¡¹ç›®ID',
    item_name VARCHAR(100) NOT NULL COMMENT 'è´¹ç”¨é¡¹ç›®åç§°',
    item_code VARCHAR(50) UNIQUE NOT NULL COMMENT 'è´¹ç”¨é¡¹ç›®ä»£ç ',
    item_type VARCHAR(20) NOT NULL COMMENT 'è´¹ç”¨ç±»å‹: TUITION-å­¦è´¹, ACCOMMODATION-ä½å®¿è´¹, TEXTBOOK-æ•™æè´¹',
    amount DECIMAL(10,2) NOT NULL COMMENT 'è´¹ç”¨é‡‘é¢',
    currency VARCHAR(3) DEFAULT 'CNY' COMMENT 'è´§å¸ç±»å‹',
    billing_cycle VARCHAR(20) COMMENT 'è®¡è´¹å‘¨æœŸ: SEMESTER-å­¦æœŸ, YEAR-å­¦å¹´, MONTH-æœˆ',
    department_id BIGINT COMMENT 'æ‰€å±é™¢ç³»ID',
    applicable_grades VARCHAR(100) COMMENT 'é€‚ç”¨å¹´çº§',
    applicable_majors VARCHAR(255) COMMENT 'é€‚ç”¨ä¸“ä¸š',
    due_date_type VARCHAR(20) COMMENT 'ç¼´è´¹æœŸé™ç±»å‹: FIXED-å›ºå®šæ—¥æœŸ, RELATIVE-ç›¸å¯¹æ—¥æœŸ',
    due_date DATE COMMENT 'å›ºå®šç¼´è´¹æˆªæ­¢æ—¥æœŸ',
    due_days INT COMMENT 'ç›¸å¯¹ç¼´è´¹å¤©æ•°',
    late_fee_rate DECIMAL(5,4) COMMENT 'æ»çº³é‡‘æ¯”ä¾‹',
    description TEXT COMMENT 'è´¹ç”¨æè¿°',
    payment_methods VARCHAR(100) COMMENT 'æ”¯æŒçš„æ”¯ä»˜æ–¹å¼',
    is_mandatory TINYINT DEFAULT 1 COMMENT 'æ˜¯å¦å¿…ç¼´: 1-å¿…ç¼´, 0-é€‰ç¼´',
    status TINYINT DEFAULT 1 COMMENT 'çŠ¶æ€: 1-å¯ç”¨, 0-ç¦ç”¨',
    effective_date DATE COMMENT 'ç”Ÿæ•ˆæ—¥æœŸ',
    expiry_date DATE COMMENT 'å¤±æ•ˆæ—¥æœŸ',
    created_time DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',
    updated_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'æ›´æ–°æ—¶é—´',
    deleted TINYINT DEFAULT 0 COMMENT 'é€»è¾‘åˆ é™¤æ ‡è®°',
    
    INDEX idx_item_code (item_code),
    INDEX idx_item_type (item_type),
    INDEX idx_department_id (department_id),
    INDEX idx_status (status),
    INDEX idx_effective_date (effective_date),
    FOREIGN KEY (department_id) REFERENCES departments(id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='è´¹ç”¨é¡¹ç›®è¡¨';
```

#### 3.2 ç¼´è´¹è®°å½•è¡¨ (payment_records)
```sql
CREATE TABLE payment_records (
    id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT 'ç¼´è´¹è®°å½•ID',
    payment_no VARCHAR(50) UNIQUE NOT NULL COMMENT 'ç¼´è´¹å•å·',
    student_id BIGINT NOT NULL COMMENT 'å­¦ç”ŸID',
    fee_item_id BIGINT NOT NULL COMMENT 'è´¹ç”¨é¡¹ç›®ID',
    amount DECIMAL(10,2) NOT NULL COMMENT 'ç¼´è´¹é‡‘é¢',
    actual_amount DECIMAL(10,2) COMMENT 'å®é™…ç¼´è´¹é‡‘é¢',
    discount_amount DECIMAL(10,2) DEFAULT 0 COMMENT 'ä¼˜æƒ é‡‘é¢',
    late_fee DECIMAL(10,2) DEFAULT 0 COMMENT 'æ»çº³é‡‘',
    payment_method VARCHAR(20) NOT NULL COMMENT 'æ”¯ä»˜æ–¹å¼: ALIPAY-æ”¯ä»˜å®, WECHAT-å¾®ä¿¡, BANK-é“¶è¡Œå¡',
    payment_channel VARCHAR(50) COMMENT 'æ”¯ä»˜æ¸ é“',
    transaction_id VARCHAR(100) COMMENT 'ç¬¬ä¸‰æ–¹äº¤æ˜“å·',
    payment_time DATETIME COMMENT 'æ”¯ä»˜æ—¶é—´',
    payment_status VARCHAR(20) DEFAULT 'PENDING' COMMENT 'æ”¯ä»˜çŠ¶æ€: PENDING-å¾…æ”¯ä»˜, SUCCESS-æˆåŠŸ, FAILED-å¤±è´¥, REFUNDED-å·²é€€æ¬¾',
    refund_amount DECIMAL(10,2) DEFAULT 0 COMMENT 'é€€æ¬¾é‡‘é¢',
    refund_time DATETIME COMMENT 'é€€æ¬¾æ—¶é—´',
    refund_reason VARCHAR(255) COMMENT 'é€€æ¬¾åŸå› ',
    academic_year VARCHAR(10) COMMENT 'å­¦å¹´',
    semester VARCHAR(10) COMMENT 'å­¦æœŸ',
    operator_id BIGINT COMMENT 'æ“ä½œå‘˜ID',
    remarks TEXT COMMENT 'å¤‡æ³¨',
    created_time DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',
    updated_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'æ›´æ–°æ—¶é—´',
    deleted TINYINT DEFAULT 0 COMMENT 'é€»è¾‘åˆ é™¤æ ‡è®°',
    
    INDEX idx_payment_no (payment_no),
    INDEX idx_student_id (student_id),
    INDEX idx_fee_item_id (fee_item_id),
    INDEX idx_payment_method (payment_method),
    INDEX idx_payment_status (payment_status),
    INDEX idx_payment_time (payment_time),
    INDEX idx_academic_year (academic_year),
    FOREIGN KEY (student_id) REFERENCES students(id),
    FOREIGN KEY (fee_item_id) REFERENCES fee_items(id),
    FOREIGN KEY (operator_id) REFERENCES users(id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='ç¼´è´¹è®°å½•è¡¨';
```

## ğŸ”— æ•°æ®åº“å…³ç³»å›¾

### ERå›¾æ¦‚è§ˆ
```
ç”¨æˆ·è¡¨ (users) 1:N ç”¨æˆ·è§’è‰²è¡¨ (user_roles) N:1 è§’è‰²è¡¨ (roles)
è§’è‰²è¡¨ (roles) 1:N è§’è‰²æƒé™è¡¨ (role_permissions) N:1 æƒé™è¡¨ (permissions)

é™¢ç³»è¡¨ (departments) 1:N è¯¾ç¨‹è¡¨ (courses)
è¯¾ç¨‹è¡¨ (courses) 1:N é€‰è¯¾è¡¨ (course_selections) N:1 å­¦ç”Ÿè¡¨ (students)

å­¦ç”Ÿè¡¨ (students) 1:N ç¼´è´¹è®°å½•è¡¨ (payment_records) N:1 è´¹ç”¨é¡¹ç›®è¡¨ (fee_items)
```

## ğŸ“ˆ ç´¢å¼•è®¾è®¡ç­–ç•¥

### ä¸»é”®ç´¢å¼•
- æ‰€æœ‰è¡¨éƒ½ä½¿ç”¨è‡ªå¢BIGINTä½œä¸ºä¸»é”®
- ç¡®ä¿å”¯ä¸€æ€§å’Œé«˜æ•ˆæŸ¥è¯¢

### å”¯ä¸€ç´¢å¼•
- ç”¨æˆ·åã€é‚®ç®±ã€æ‰‹æœºå·ç­‰å”¯ä¸€å­—æ®µ
- è¯¾ç¨‹ä»£ç ã€é™¢ç³»ä»£ç ç­‰ä¸šåŠ¡å”¯ä¸€æ ‡è¯†

### å¤åˆç´¢å¼•
- é€‰è¯¾è¡¨: (student_id, course_id, selection_period_id)
- ç¼´è´¹è®°å½•: (student_id, fee_item_id, academic_year)
- æˆç»©è¡¨: (student_id, course_id, exam_id)

### æŸ¥è¯¢ä¼˜åŒ–ç´¢å¼•
- çŠ¶æ€å­—æ®µç´¢å¼•: æ”¯æŒæŒ‰çŠ¶æ€å¿«é€Ÿç­›é€‰
- æ—¶é—´å­—æ®µç´¢å¼•: æ”¯æŒæŒ‰æ—¶é—´èŒƒå›´æŸ¥è¯¢
- å¤–é”®ç´¢å¼•: æå‡å…³è”æŸ¥è¯¢æ€§èƒ½

## ğŸ”’ æ•°æ®å®‰å…¨è®¾è®¡

### æ•æ„Ÿæ•°æ®åŠ å¯†
- ç”¨æˆ·å¯†ç : BCryptåŠ å¯†
- èº«ä»½è¯å·: AES-256åŠ å¯†
- é“¶è¡Œå¡å·: AES-256åŠ å¯†

### è½¯åˆ é™¤æœºåˆ¶
- æ‰€æœ‰ä¸šåŠ¡è¡¨éƒ½åŒ…å«deletedå­—æ®µ
- åˆ é™¤æ“ä½œåªæ›´æ–°deletedæ ‡è®°
- æŸ¥è¯¢æ—¶è¿‡æ»¤deleted=1çš„è®°å½•

### å®¡è®¡æ—¥å¿—
- è®°å½•æ‰€æœ‰æ•°æ®å˜æ›´æ“ä½œ
- åŒ…å«æ“ä½œäººã€æ“ä½œæ—¶é—´ã€æ“ä½œå†…å®¹
- æ”¯æŒæ•°æ®æ¢å¤å’Œé—®é¢˜è¿½è¸ª

---

*æ–‡æ¡£ç‰ˆæœ¬: v1.0 | æœ€åæ›´æ–°: 2025å¹´6æœˆ13æ—¥*
