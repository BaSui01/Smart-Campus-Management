# 校园管理系统数据库初始化脚本

## 概述

本目录包含校园管理系统的完整数据库初始化脚本，包括表结构创建、索引创建、基础数据插入和大量测试数据生成。

## 文件说明

### SQL脚本文件

| 文件名 | 说明 | 记录数量 |
|--------|------|----------|
| `00_create_database.sql` | 创建数据库 | - |
| `01_create_tables.sql` | 创建所有表结构 | 13个表 |
| `02_create_indexes.sql` | 创建索引和外键约束 | 60+个索引 |
| `03_insert_base_data.sql` | 插入基础数据（角色、权限、班级等） | 500+条 |
| `04_insert_user_student_data.sql` | 插入用户和学生数据（2021-2025级） | 1550+条 |
| `05_insert_course_data.sql` | 插入课程和课程表数据 | 300+条 |
| `06_insert_selection_data.sql` | 插入选课数据 | 8000+条 |
| `07_insert_grade_data.sql` | 插入成绩数据 | 8000+条 |
| `08_insert_payment_data.sql` | 插入缴费记录数据 | 12000+条 |
| `09_final_statistics.sql` | 生成最终统计报告 | - |
| `run_all_scripts.sql` | 执行所有脚本的主脚本 | - |

### 执行脚本

| 文件名 | 说明 | 适用系统 |
|--------|------|----------|
| `run_database_init.ps1` | PowerShell执行脚本 | Windows |
| `run_database_init.bat` | 批处理执行脚本 | Windows |

## 数据库配置

### 连接参数

- **主机**: localhost
- **端口**: 3306
- **用户名**: root
- **密码**: xiaoxiao123
- **数据库名**: campus_management_db
- **字符编码**: UTF-8 (utf8mb4)

### 默认管理员账户

- **用户名**: admin
- **密码**: admin123

## 使用方法

### 方法一：使用PowerShell脚本（推荐）

1. 打开PowerShell（以管理员身份运行）
2. 导航到database目录
3. 执行脚本：

```powershell
cd database
.\run_database_init.ps1
```

### 方法二：使用批处理脚本

1. 打开命令提示符（以管理员身份运行）
2. 导航到database目录
3. 执行脚本：

```cmd
cd database
run_database_init.bat
```

### 方法三：手动执行SQL脚本

1. 打开MySQL命令行客户端
2. 按顺序执行以下脚本：

```sql
mysql -u root -p < 00_create_database.sql
mysql -u root -p < 01_create_tables.sql
mysql -u root -p < 02_create_indexes.sql
mysql -u root -p < 03_insert_base_data.sql
mysql -u root -p < 04_insert_user_student_data.sql
mysql -u root -p < 05_insert_course_data.sql
mysql -u root -p < 06_insert_selection_data.sql
mysql -u root -p < 07_insert_grade_data.sql
mysql -u root -p < 08_insert_payment_data.sql
```

### 方法四：使用主脚本

```sql
mysql -u root -p < run_all_scripts.sql
```

## 数据统计

执行完成后，数据库将包含以下数据：

| 表名 | 预计记录数 | 说明 |
|------|------------|------|
| tb_user | 1550+ | 用户表（管理员、教师、学生） |
| tb_role | 7 | 角色表 |
| tb_permission | 30+ | 权限表 |
| tb_user_role | 1550+ | 用户角色关联 |
| tb_role_permission | 100+ | 角色权限关联 |
| tb_class | 65+ | 班级表（7个专业，2021-2025级） |
| tb_student | 1500+ | 学生表（2021-2025级） |
| tb_course | 100+ | 课程表（含2025学年新课程） |
| tb_course_schedule | 300+ | 课程表排课 |
| tb_course_selection | 8000+ | 选课记录 |
| tb_grade | 8000+ | 成绩记录（含补考） |
| tb_fee_item | 60+ | 缴费项目（2021-2025学年） |
| tb_payment_record | 12000+ | 缴费记录 |

### 年级分布（2021-2025级）

- **2021级**: 约300名学生（即将毕业）
- **2022级**: 约300名学生
- **2023级**: 约300名学生
- **2024级**: 约300名学生
- **2025级**: 约300名学生（新入学）

### 专业分布

- **计算机科学与技术**: 15个班级（每个年级3个班）
- **软件工程**: 15个班级（每个年级3个班）
- **信息安全**: 10个班级（每个年级2个班）
- **数据科学与大数据技术**: 8个班级（2022-2025级，每年级2个班）
- **人工智能**: 8个班级（2022-2025级，每年级2个班）
- **物联网工程**: 6个班级（2022-2025级）
- **网络工程**: 5个班级（2021-2025级）

### 课程分布

- **专业必修课**: 50+ 门
- **专业选修课**: 40+ 门
- **公共基础课**: 25+ 门
- **通识教育课**: 15+ 门
- **2025学年新增课程**: 16门（包含前沿技术课程）

### 数据特色

- **真实姓名**: 150+个姓氏，200+个现代化名字
- **多学年数据**: 覆盖2021-2025学年的完整数据
- **丰富课程**: 包含最新技术趋势的课程设置
- **完整流程**: 从入学到毕业的完整学生生命周期

### 专业分布

- **计算机科学与技术**: 9个班级（2021-2023级）
- **软件工程**: 9个班级（2021-2023级）
- **信息安全**: 6个班级（2021-2023级）
- **数据科学与大数据技术**: 4个班级（2022-2023级）
- **人工智能**: 3个班级（2022-2023级）
- **物联网工程**: 2个班级（2022-2023级）
- **网络工程**: 3个班级（2021-2023级）

### 课程分布

- **专业必修课**: 40+ 门
- **专业选修课**: 30+ 门
- **公共基础课**: 20+ 门
- **通识教育课**: 10+ 门

### 姓名数据

- **姓氏库**: 150+ 个常见姓氏
- **名字库**: 200+ 个现代化名字（包含传统和现代风格）
- **自动生成**: 真实感强的中文姓名组合

## 注意事项

### 系统要求

1. **MySQL 5.7+** 或 **MySQL 8.0+**
2. **Windows 10+** 操作系统
3. **PowerShell 5.0+** （推荐使用PowerShell脚本）

### 执行前检查

1. 确保MySQL服务已启动
2. 确保mysql命令在系统PATH中，或修改脚本中的MySQL路径
3. 确保数据库用户有足够的权限创建数据库和表
4. 确保有足够的磁盘空间（建议至少500MB）

### 字符编码

- 所有脚本使用UTF-8编码
- 数据库使用utf8mb4字符集
- 支持中文字符和emoji

### 执行时间

- 完整执行时间约5-15分钟（取决于硬件性能）
- 大部分时间用于生成大量测试数据

## 故障排除

### 常见问题

1. **MySQL客户端不可用**
   - 检查MySQL是否已安装
   - 检查mysql命令是否在PATH中
   - 修改脚本中的MYSQL_PATH变量

2. **数据库连接失败**
   - 检查MySQL服务是否启动
   - 检查用户名和密码是否正确
   - 检查防火墙设置

3. **权限不足**
   - 确保数据库用户有CREATE、DROP、INSERT等权限
   - 使用管理员权限运行脚本

4. **字符编码问题**
   - 确保控制台支持UTF-8编码
   - 检查MySQL配置中的字符集设置

### 重新初始化

如果需要重新初始化数据库：

1. 删除现有数据库：
```sql
DROP DATABASE IF EXISTS campus_management_db;
```

2. 重新执行初始化脚本

## 技术特性

### 数据生成策略

- 使用存储过程批量生成数据
- 随机分布算法确保数据真实性
- 关联数据保持一致性
- 支持大规模数据生成

### 性能优化

- 合理的索引设计
- 外键约束保证数据完整性
- 批量插入提高性能
- 事务处理确保数据一致性

### 扩展性

- 模块化脚本设计
- 易于添加新的数据类型
- 支持自定义数据量
- 兼容不同MySQL版本

## 联系信息

如有问题或建议，请联系开发团队。
